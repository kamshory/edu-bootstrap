function initTest(){let e;for(e=0;e<questionSet.length;e++)answerData[e]={question:questionSet[e],read:0,answer:0,doubt:0};loadAnswer()}function loadAnswer(){let e=window.localStorage.getItem(storageKey+"-answer-set")||"",t=loadCurrentIndex();if(""!=e){let t=JSON.parse(e);if(t.length){answerData=t;for(let e in answerData){let t=answerData[e].question,n=answerData[e].answer;$("#answer_"+t).val(n)}}}"0"!=t&&(currentIndex=parseInt(t))}function saveAnswer(){let e=JSON.stringify(answerData);window.localStorage.setItem(storageKey+"-answer-set",e)}function saveCurrentIndex(){window.localStorage.setItem(storageKey+"-current-index",currentIndex)}function loadCurrentIndex(){return window.localStorage.getItem(storageKey+"-current-index")||"0"}function createSidebarNumber(){let e,t;for($(".question-number").empty(),e=0,t=1;e<questionSet.length;e++,t++)$(".question-number").append('\r\n<li data-number="'+t+'"><a href="#"><span>'+t+"</span></a></li>")}function renderSidebar(){let e,t,n;for(e=0,t=1;e<answerData.length;e++,t++)n=answerData[e],0==n.read?$('.question-number li[data-number="'+t+'"]').removeClass("unread").addClass("unread"):1==n.read&&$('.question-number li[data-number="'+t+'"]').removeClass("unread"),1==n.doubt?$('.question-number li[data-number="'+t+'"]').removeClass("doubt").addClass("doubt"):0==n.doubt&&$('.question-number li[data-number="'+t+'"]').removeClass("doubt"),0!=n.answer?$('.question-number li[data-number="'+t+'"]').removeClass("answered").addClass("answered"):0==n.answer&&$('.question-number li[data-number="'+t+'"]').removeClass("answered");let a=$("#doubt").val();a=a.replace(String.fromCharCode(9635)+" ",""),a=a.replace(String.fromCharCode(9634)+" ",""),0==answerData[currentIndex].doubt?(a=String.fromCharCode(9634)+" "+a,$(".current-number-placeholder").removeClass("doubt")):(a=String.fromCharCode(9635)+" "+a,$(".current-number-placeholder").removeClass("doubt").addClass("doubt")),$(".current-number").text(currentIndex+1),$(".question-number li").removeClass("current-index"),$('.question-number li[data-number="'+(currentIndex+1)+'"]').removeClass("current-index").addClass("current-index"),$("#doubt").val(a)}function renderQuestion(e){try{$(".question-area").attr({"data-index":e,"data-question-id":questionSet[e]});let t,n,a=questionData[e].text,r=questionData[e].options,o=questionData[e].numbering,i="";for(t=0;t<r.length;t++)n=r[t],i+='\r\n\t\t<div class="option" data-option-id="'+n.option_id+'"><div class="option-ctrl"><a href="#">'+numberingList[o][t]+"</a></div> "+n.text+"</div>\r\n";i+='\r\n\t\t<div class="option not-answer" data-option-id="0"><div class="option-ctrl"><a href="#">'+numberingList[o][t]+"</a></div> "+optionNotAnswer+"</div>\r\n";let s='\t<div class="question">\r\n\t\t'+a+'\t</div>\r\n\t<div class="option-area">\r\n'+i+"\t</div>\r\n";$(".question-area").empty().append(s)}catch(e){}}function renderAnswer(e){let t=answerData[e];$(".option-area .option").removeClass("answered").removeClass("doubt"),$('.option-area .option[data-option-id="'+t.answer+'"]').addClass("answered"),0!=t.answer?$(".current-number-placeholder").removeClass("answered").addClass("answered"):$(".current-number-placeholder").removeClass("answered"),0!=t.doubt?$('.option-area .option[data-option-id="'+t.answer+'"]').removeClass("doubt").addClass("doubt"):$('.option-area .option[data-option-id="'+t.answer+'"]').removeClass("doubt")}function selectQuestion(e){try{currentIndex=e,answerData[currentIndex].read=1,saveAnswer(),saveCurrentIndex(),renderSidebar(),renderQuestion(e),renderAnswer(e)}catch(e){}}function selectAnswer(e,t){try{answerData[e].read=1,answerData[e].answer=t;let n=answerData[e].question,a=answerData[e].answer;$("#answer_"+n).val(a),saveAnswer(),renderSidebar(),renderAnswer(e)}catch(e){}}function nextQuestion(){currentIndex<questionSet.length-1&&(currentIndex++,selectQuestion(currentIndex))}function prevQuestion(){currentIndex>0&&(currentIndex--,selectQuestion(currentIndex))}function preloadImage(e){let t,n,a,r,o=[];for(t=0;t<e.length;t++)for(n=$("<div>"+e[t].text+"</div>"),n.find("img").each(function(e,t){o.push($(this).attr("src"))}),a=0;a<e[t].options.length;a++)r=$("<div>"+e[t].options[a].text+"</div>"),r.find("img").each(function(e,t){o.push($(this).attr("src"))});let i=[];for(t=0;t<o.length;t++)n=o[t],i[t]=new Image,i[t].src=n}function submitTest(){let e=checkDoubtAnswer();0==e?$("#testfrm").submit():(customAlert("Anda tidak bisa mengirim jawaban sekarang karena masih ada "+e+" jawaban ragu-ragu. Silakan buang centang jawaban ragu-ragu lalu coba lagi.","Tutup"),$(".test-question-control").removeClass("hidden"),$(".question-number .doubt.answered:first a").click())}function customAlert(e,t){t=t||"Tutup",$(".dialog-mask, .dialog-container").remove();let n='<div class="dialog-mask"></div>\r\n<div class="dialog-container">\r\n\t<div class="dialog-body">'+e+'</div>\r\n\t<div class="dialog-button-panel"><button data-dismiss="true">'+t+"</button></div>\r\n</div>\r\n";$("body").append(n),$('.dialog-button-panel button[data-dismiss="true"]').on("click",function(e){$(".dialog-mask, .dialog-container").remove()})}function customConfirm(e,t,n,a){n=n||"Ya",a=a||"Tidak",$(".dialog-mask, .dialog-container").remove();let r='<div class="dialog-mask"></div>\r\n<div class="dialog-container">\r\n\t<div class="dialog-body">'+e+'</div>\r\n\t<div class="dialog-button-panel"><button data-button="1">'+n+'</button> <button data-button="2" data-dismiss="true">'+a+"</button></div>\r\n</div>\r\n";$("body").append(r),$('.dialog-button-panel button[data-button="1"]').on("click",function(e){t(),$(".dialog-mask, .dialog-container").remove()}),$('.dialog-button-panel button[data-dismiss="true"]').on("click",function(e){$(".dialog-mask, .dialog-container").remove()})}function checkDoubtAnswer(){let e,t=0;for(e=0;e<answerData.length;e++)1==answerData[e].doubt&&0!=answerData[e].answer&&t++;return t}function secondsToTime(e){let t=Math.floor(e/3600),n=e%3600,a=Math.floor(n/60),r=n%60,o=Math.ceil(r);t<10&&t>=0&&(t="0"+t),a<10&&a>=0&&(a="0"+a),o<10&&o>=0&&(o="0"+o);let i={h:t,m:a,s:o};return i}function displayRemainingTime(e){let t=new Date,n=parseInt(t.getTime()/1e3),a=tval-n;autosubmit&&(a-=10);let r="";a<=alert_time&&($(".timer-placeholder").attr("data-has-alert","true"),hideAlert||$(".alert-placeholder").attr("data-hidden","false")),a<10&&autosubmit&&(document.testfrm.submit(),clearInterval(intervalID)),a<0&&(a=-a,r="Lewat ",$(".timer-placeholder").attr("data-time-over","true"));let o=secondsToTime(a);$(e).text(r+o.h+":"+o.m+":"+o.s)}$(document).ready(function(e){preloadImage(questionData),initTest(),createSidebarNumber(),renderSidebar(),selectQuestion(currentIndex),$(document).on("click","#next",function(e){nextQuestion()}),$(document).on("click","#prev",function(e){prevQuestion()}),$(document).on("click","#doubt",function(e){0==answerData[currentIndex].doubt?answerData[currentIndex].doubt=1:answerData[currentIndex].doubt=0,saveAnswer(),renderSidebar(),renderAnswer(currentIndex)}),$(document).on("click",".question-number li a",function(e){let t=parseInt($(this).closest("li").attr("data-number"))-1;selectQuestion(t),e.preventDefault()}),$(document).on("click",".option-area a",function(e){selectAnswer(parseInt($(this).closest(".question-area").attr("data-index")),parseInt($(this).closest(".option").attr("data-option-id"))),e.preventDefault()}),$(document).on("click",".test-question-control .before a",function(e){let t=$(this).closest(".test-question-control");t.hasClass("hidden")?t.removeClass("hidden"):t.addClass("hidden"),e.preventDefault()}),$(document).on("click","#submit",function(e){customConfirm("Apakah Anda akan mengirimkan jawaban ujian ini sekarang?",function(){setTimeout(function(){submitTest()},10)},"Ya","Tidak")}),$(document).on("click",".alert-closer",function(e){hideAlert=!0,$(".alert-placeholder").attr("data-hidden","true"),e.preventDefault()}),$(document).on("keydown",function(e){if(e.keyCode>=65&&e.keyCode<=80){let t=e.keyCode-64;$(".option-area .option:nth-child("+t+") .option-ctrl a").click(),e.preventDefault()}if(e.keyCode>=49&&e.keyCode<=57){let t=e.keyCode-48;$(".question-number li:nth-child("+t+") a").click(),e.preventDefault()}48==e.keyCode&&($(".question-number li:nth-child(10) a").click(),e.preventDefault()),e.keyCode=="R".charCodeAt(0)&&($("input#doubt").click(),e.preventDefault()),37==e.keyCode&&(prevQuestion(),e.preventDefault()),39==e.keyCode&&(nextQuestion(),e.preventDefault()),38==e.keyCode&&(currentIndex>4&&(currentIndex-=5,selectQuestion(currentIndex)),e.preventDefault()),40==e.keyCode&&(currentIndex<questionSet.length-5&&(currentIndex+=5,selectQuestion(currentIndex)),e.preventDefault())}),$(document).on("contextmenu",function(e){e.preventDefault(),e.stopPropagation()});let t=new Date,n=parseInt(t.getTime()/1e3);tval=due_time+n,intervalID=setInterval(function(){displayRemainingTime(".timer")},1e3),displayRemainingTime(".timer")});let tval,hideAlert=!1,intervalID=null,blankObject={question:0,read:0,answer:0,doubt:0},answerData=[],currentIndex=0,optionNotAnswer="Tidak menjawab",numberingList={"upper-alpha":["A","B","C","D","E","F","G","H","I","J"],"lower-alpha":["a","b","c","d","e","f","g","h","i","j"],"upper-roman":["I","II","III","IV","V","VI","VII","VIII","IX","X"],"lower-roman":["i","ii","iii","iv","v","vi","vii","vii","ix","x"],decimal:["1","2","3","4","5","6","7","8","9","10"],"decimal-leading-zero":["01","02","03","04","05","06","07","08","09","10"]};