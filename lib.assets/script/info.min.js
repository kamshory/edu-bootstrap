function convertImagesToBase64(t){var e=t.find("img"),a=document.createElement("canvas"),i=a.getContext("2d");return[].forEach.call(e,function(t){var e=t;i.clearRect(0,0,a.width,a.height),a.width=e.width,a.height=e.height,i.drawImage(e,0,0,e.width,e.height);var o=a.toDataURL();e.setAttribute("src",o),e.style.width=a.width+"px",e.style.maxWidth="100%",e.style.height="auto",e.removeAttribute("height")}),a.remove(),t}function replaceBase(t){var e=t.find("a"),a="";return[].forEach.call(e,function(t){var e=t;a=e.getAttribute("href"),a=convertRelToAbsUrl(a),e.setAttribute("href",a)}),t}function convertRelToAbsUrl(t){var e=null;if(/^(https?|file|ftps?|mailto|javascript|data:image\/[^;]{2,9};):/i.test(t))return t;if(e=window.location.href.match(/^(.+)\/?(?:#.+)?$/)[0]+"/","//"===t.substring(0,2))return location.protocol+t;if("/"===t.charAt(0))return location.protocol+"//"+location.host+t;if("./"===t.substring(0,2))t="."+t;else if(/^\s*$/.test(t))return"";for(t=e+"../"+t;/\/\.\.\//.test(t);)t=t.replace(/[^\/]+\/+\.\.\//g,"");return t=t.replace(/\.$/,"").replace(/\/\./g,"").replace(/"/g,"%22").replace(/'/g,"%27").replace(/</g,"%3C").replace(/>/g,"%3E"),t}$(document).ready(function(t){$(document).on("click",".delete-post",function(t){var e=$(this).attr("data-id");confirm("Apakah Anda akan menghapus artikel ini?")&&$.post("ajax-delete-artikel.php",{article_id:e,option:"delete"},function(t){window.location="artikel.php"}),t.preventDefault()}),$(document).on("click",".download-word",function(t){var e=$(".article-title").text(),a=$(".article-content").html(),i=$(".article-creator").text(),o="<div><h1>"+e+"</h1>\r\n<div>"+i+"</div>"+a+"</div>",r=$(o);r=convertImagesToBase64(r),r=replaceBase(r);a=r.html();var n='<style type="text/css">body{font-family:"Times New Roman", Times, serif; font-size:16px; position:relative;} table[border="1"]{border-collapse:collapse; box-sizing:border-box; max-width:100%;} table[border="1"] td{padding:4px 5px;} table[border="0"] td{padding:4px 0;} p, li{line-height:1.5;} a{color:#000000; text-decoration:none;} h1{font-size:30px;} h2{font-size:26px;} h3{font-size:22px;} h4{font-size:16px;}</style>';a='<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>'+e+"</title>"+n+'</head><body style="position:relative;">'+a+"</body></html>";var l=new Blob([a],{type:"text/html"});saveAs(l,e+".html"),t.preventDefault()})});