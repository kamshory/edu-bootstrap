(function(e,t){"function"==typeof define&&define.amd?define(["exports"],t):"object"==typeof exports&&"string"!=typeof exports.nodeName?t(exports):t(e.commonJsStrict={})})(this,function(e){function t(e){if(e in Q)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=$.length;n--;)if(e=$[n]+t,e in Q)return e}function n(e,t){var n=G.indexOf(e)>-1?G:J,i=n.indexOf(e),o=t/90%n.length;return n[(n.length+i+o%n.length)%n.length]}function i(e,t){for(var n in e=e||{},t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},i(e[n],t[n])):e[n]=t[n];return e}function o(e){return i({},e)}function r(e,t,n){var i;return function(){var o=this,r=arguments,a=function(){i=null,n||e.apply(o,r)},s=n&&!i;clearTimeout(i),i=setTimeout(a,t),s&&e.apply(o,r)}}function a(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function s(e,t,n){if("string"==typeof t){var i=t;t={},t[i]=n}for(var o in t)e.style[o]=t[o]}function l(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function u(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"")}function c(e,t){for(var n in t)e.setAttribute(n,t[n])}function h(e){return parseInt(e,10)}function p(e,t){var n=new Image;return n.style.opacity=0,new Promise(function(i){function o(){n.style.opacity=1,setTimeout(function(){i(n)},1)}n.removeAttribute("crossOrigin"),e.match(/^https?:\/\/|^\/\//)&&n.setAttribute("crossOrigin","anonymous"),n.onload=function(){t?EXIF.getData(n,function(){o()}):o()},n.src=e})}function d(e,t){var n=e.naturalWidth,i=e.naturalHeight,o=t||m(e);if(o&&o>=5){var r=n;n=i,i=r}return{width:n,height:i}}function m(e){return e.exifdata?e.exifdata.Orientation:1}function f(e,t,n){var i=t.width,o=t.height,r=e.getContext("2d");switch(e.width=t.width,e.height=t.height,r.save(),n){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,o),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,o),r.scale(1,-1);break;case 5:e.width=o,e.height=i,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:e.width=o,e.height=i,r.rotate(90*Math.PI/180),r.translate(0,-o);break;case 7:e.width=o,e.height=i,r.rotate(-90*Math.PI/180),r.translate(-i,o),r.scale(1,-1);break;case 8:e.width=o,e.height=i,r.translate(0,i),r.rotate(-90*Math.PI/180)}r.drawImage(t,0,0,i,o),r.restore()}function v(){var e,t,n,i,o,r=this,a="croppie-container",u=r.options.viewport.type?"cr-vp-"+r.options.viewport.type:null;r.options.useCanvas=r.options.enableOrientation||g.call(r),r.data={},r.elements={},e=r.elements.boundary=document.createElement("div"),t=r.elements.viewport=document.createElement("div"),r.elements.img=document.createElement("img"),n=r.elements.overlay=document.createElement("div"),r.options.useCanvas?(r.elements.canvas=document.createElement("canvas"),r.elements.preview=r.elements.canvas):r.elements.preview=r.elements.img,l(e,"cr-boundary"),e.setAttribute("aria-dropeffect","none"),i=r.options.boundary.width,o=r.options.boundary.height,s(e,{width:i+(isNaN(i)?"":"px"),height:o+(isNaN(o)?"":"px")}),l(t,"cr-viewport"),u&&l(t,u),s(t,{width:r.options.viewport.width+"px",height:r.options.viewport.height+"px"}),t.setAttribute("tabindex",0),l(r.elements.preview,"cr-image"),c(r.elements.preview,{alt:"preview","aria-grabbed":"false"}),l(n,"cr-overlay"),r.element.appendChild(e),e.appendChild(r.elements.preview),e.appendChild(t),e.appendChild(n),l(r.element,a),r.options.customClass&&l(r.element,r.options.customClass),L.call(this),r.options.enableZoom&&b.call(r),r.options.enableResize&&w.call(r)}function g(){return this.options.enableExif&&window.EXIF}function w(){function e(e){if((void 0===e.button||0===e.button)&&(e.preventDefault(),!m)){var s=p.elements.overlay.getBoundingClientRect();if(m=!0,o=e.pageX,r=e.pageY,i=-1!==e.currentTarget.className.indexOf("vertical")?"v":"h",a=s.width,u=s.height,e.touches){var l=e.touches[0];o=l.pageX,r=l.pageY}window.addEventListener("mousemove",t),window.addEventListener("touchmove",t),window.addEventListener("mouseup",n),window.addEventListener("touchend",n),document.body.style[U]="none"}}function t(e){var t=e.pageX,n=e.pageY;if(e.preventDefault(),e.touches){var l=e.touches[0];t=l.pageX,n=l.pageY}var c=t-o,h=n-r,m=p.options.viewport.height+h,v=p.options.viewport.width+c;"v"===i&&m>=f&&m<=u?(s(d,{height:m+"px"}),p.options.boundary.height+=h,s(p.elements.boundary,{height:p.options.boundary.height+"px"}),p.options.viewport.height+=h,s(p.elements.viewport,{height:p.options.viewport.height+"px"})):"h"===i&&v>=f&&v<=a&&(s(d,{width:v+"px"}),p.options.boundary.width+=c,s(p.elements.boundary,{width:p.options.boundary.width+"px"}),p.options.viewport.width+=c,s(p.elements.viewport,{width:p.options.viewport.width+"px"})),_.call(p),z.call(p),E.call(p),B.call(p),r=n,o=t}function n(){m=!1,window.removeEventListener("mousemove",t),window.removeEventListener("touchmove",t),window.removeEventListener("mouseup",n),window.removeEventListener("touchend",n),document.body.style[U]=""}var i,o,r,a,u,c,h,p=this,d=document.createElement("div"),m=!1,f=50;l(d,"cr-resizer"),s(d,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(c=document.createElement("div"),l(c,"cr-resizer-vertical"),d.appendChild(c)),this.options.resizeControls.width&&(h=document.createElement("div"),l(h,"cr-resizer-horisontal"),d.appendChild(h)),c&&(c.addEventListener("mousedown",e),c.addEventListener("touchstart",e)),h&&(h.addEventListener("mousedown",e),h.addEventListener("touchstart",e)),this.elements.boundary.appendChild(d)}function y(e){if(this.options.enableZoom){var t=this.elements.zoomer,n=j(e,4);t.value=Math.max(t.min,Math.min(t.max,n))}}function b(){function e(){x.call(n,{value:parseFloat(o.value),origin:new te(n.elements.preview),viewportRect:n.elements.viewport.getBoundingClientRect(),transform:ee.parse(n.elements.preview)})}function t(t){var i,o;if("ctrl"===n.options.mouseWheelZoom&&!0!==t.ctrlKey)return 0;i=t.wheelDelta?t.wheelDelta/1200:t.deltaY?t.deltaY/1060:t.detail?t.detail/-60:0,o=n._currentZoom+i*n._currentZoom,t.preventDefault(),y.call(n,o),e.call(n)}var n=this,i=n.elements.zoomerWrap=document.createElement("div"),o=n.elements.zoomer=document.createElement("input");l(i,"cr-slider-wrap"),l(o,"cr-slider"),o.type="range",o.step="0.0001",o.value=1,o.style.display=n.options.showZoomer?"":"none",o.setAttribute("aria-label","zoom"),n.element.appendChild(i),i.appendChild(o),n._currentZoom=1,n.elements.zoomer.addEventListener("input",e),n.elements.zoomer.addEventListener("change",e),n.options.mouseWheelZoom&&(n.elements.boundary.addEventListener("mousewheel",t),n.elements.boundary.addEventListener("DOMMouseScroll",t))}function x(e){function t(){var e={};e[K]=i.toString(),e[q]=r.toString(),s(n.elements.preview,e)}var n=this,i=e?e.transform:ee.parse(n.elements.preview),o=e?e.viewportRect:n.elements.viewport.getBoundingClientRect(),r=e?e.origin:new te(n.elements.preview);if(n._currentZoom=e?e.value:n._currentZoom,i.scale=n._currentZoom,n.elements.zoomer.setAttribute("aria-valuenow",n._currentZoom),t(),n.options.enforceBoundary){var a=C.call(n,o),l=a.translate,u=a.origin;i.x>=l.maxX&&(r.x=u.minX,i.x=l.maxX),i.x<=l.minX&&(r.x=u.maxX,i.x=l.minX),i.y>=l.maxY&&(r.y=u.minY,i.y=l.maxY),i.y<=l.minY&&(r.y=u.maxY,i.y=l.minY)}t(),ne.call(n),B.call(n)}function C(e){var t=this,n=t._currentZoom,i=e.width,o=e.height,r=t.elements.boundary.clientWidth/2,a=t.elements.boundary.clientHeight/2,s=t.elements.preview.getBoundingClientRect(),l=s.width,u=s.height,c=i/2,h=o/2,p=-1*(c/n-r),d=p-(l*(1/n)-i*(1/n)),m=-1*(h/n-a),f=m-(u*(1/n)-o*(1/n)),v=1/n*c,g=l*(1/n)-v,w=1/n*h,y=u*(1/n)-w;return{translate:{maxX:p,minX:d,maxY:m,minY:f},origin:{maxX:g,minX:v,maxY:y,minY:w}}}function E(){var e=this,t=e._currentZoom,n=e.elements.preview.getBoundingClientRect(),i=e.elements.viewport.getBoundingClientRect(),o=ee.parse(e.elements.preview.style[K]),r=new te(e.elements.preview),a=i.top-n.top+i.height/2,l=i.left-n.left+i.width/2,u={},c={};u.y=a/t,u.x=l/t,c.y=(u.y-r.y)*(1-t),c.x=(u.x-r.x)*(1-t),o.x-=c.x,o.y-=c.y;var h={};h[q]=u.x+"px "+u.y+"px",h[K]=o.toString(),s(e.elements.preview,h)}function L(){function e(e,t){var n=m.elements.preview.getBoundingClientRect(),i=d.y+t,o=d.x+e;m.options.enforceBoundary?(p.top>n.top+t&&p.bottom<n.bottom+t&&(d.y=i),p.left>n.left+e&&p.right<n.right+e&&(d.x=o)):(d.y=i,d.x=o)}function t(e){m.elements.preview.setAttribute("aria-grabbed",e),m.elements.boundary.setAttribute("aria-dropeffect",e?"move":"none")}function n(e){function t(e){switch(e){case n:return[1,0];case o:return[0,1];case r:return[-1,0];case a:return[0,-1]}}var n=37,o=38,r=39,a=40;if(!e.shiftKey||e.keyCode!==o&&e.keyCode!==a){if(m.options.enableKeyMovement&&e.keyCode>=37&&e.keyCode<=40){e.preventDefault();var s=t(e.keyCode);d=ee.parse(m.elements.preview),document.body.style[U]="none",p=m.elements.viewport.getBoundingClientRect(),i(s)}}else{var l=0;l=e.keyCode===o?parseFloat(m.elements.zoomer.value,10)+parseFloat(m.elements.zoomer.step,10):parseFloat(m.elements.zoomer.value,10)-parseFloat(m.elements.zoomer.step,10),m.setZoom(l)}}function i(t){var n=t[0],i=t[1],o={};e(n,i),o[K]=d.toString(),s(m.elements.preview,o),_.call(m),document.body.style[U]="",E.call(m),B.call(m),h=0}function o(e){if((void 0===e.button||0===e.button)&&(e.preventDefault(),!f)){if(f=!0,u=e.pageX,c=e.pageY,e.touches){var n=e.touches[0];u=n.pageX,c=n.pageY}t(f),d=ee.parse(m.elements.preview),window.addEventListener("mousemove",r),window.addEventListener("touchmove",r),window.addEventListener("mouseup",l),window.addEventListener("touchend",l),document.body.style[U]="none",p=m.elements.viewport.getBoundingClientRect()}}function r(t){t.preventDefault();var n=t.pageX,i=t.pageY;if(t.touches){var o=t.touches[0];n=o.pageX,i=o.pageY}var r=n-u,l=i-c,p={};if("touchmove"===t.type&&t.touches.length>1){var f=t.touches[0],v=t.touches[1],g=Math.sqrt((f.pageX-v.pageX)*(f.pageX-v.pageX)+(f.pageY-v.pageY)*(f.pageY-v.pageY));h||(h=g/m._currentZoom);var w=g/h;return y.call(m,w),void a(m.elements.zoomer)}e(r,l),p[K]=d.toString(),s(m.elements.preview,p),_.call(m),c=i,u=n}function l(){f=!1,t(f),window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",r),window.removeEventListener("mouseup",l),window.removeEventListener("touchend",l),document.body.style[U]="",E.call(m),B.call(m),h=0}var u,c,h,p,d,m=this,f=!1;m.elements.overlay.addEventListener("mousedown",o),m.elements.viewport.addEventListener("keydown",n),m.elements.overlay.addEventListener("touchstart",o)}function _(){if(this.elements){var e=this,t=e.elements.boundary.getBoundingClientRect(),n=e.elements.preview.getBoundingClientRect();s(e.elements.overlay,{width:n.width+"px",height:n.height+"px",top:n.top-t.top+"px",left:n.left-t.left+"px"})}}function B(){var e,t=this,n=t.get();R.call(t)&&(t.options.update.call(t,n),t.$&&"undefined"==typeof Prototype?t.$(t.element).trigger("update.croppie",n):(window.CustomEvent?e=new CustomEvent("update",{detail:n}):(e=document.createEvent("CustomEvent"),e.initCustomEvent("update",!0,!0,n)),t.element.dispatchEvent(e)))}function R(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function Z(){var e=this,t=1,n={},i=e.elements.preview,o=null,r=new ee(0,0,t),a=new te,l=R.call(e);l&&!e.data.bound&&(e.data.bound=!0,n[K]=r.toString(),n[q]=a.toString(),n.opacity=1,s(i,n),o=e.elements.preview.getBoundingClientRect(),e._originalImageWidth=o.width,e._originalImageHeight=o.height,e.data.orientation=m(e.elements.img),e.options.enableZoom?z.call(e,!0):e._currentZoom=t,r.scale=e._currentZoom,n[K]=r.toString(),s(i,n),e.data.points.length?M.call(e,e.data.points):I.call(e),E.call(e),_.call(e))}function z(e){var t,n,i,o,r=this,s=0,l=r.options.maxZoom||1.5,u=r.elements.zoomer,c=parseFloat(u.value),h=r.elements.boundary.getBoundingClientRect(),p=d(r.elements.img,r.data.orientation),m=r.elements.viewport.getBoundingClientRect();r.options.enforceBoundary&&(i=m.width/p.width,o=m.height/p.height,s=Math.max(i,o)),s>=l&&(l=s+1),u.min=j(s,4),u.max=j(l,4),!e&&(c<u.min||c>u.max)?y.call(r,c<u.min?u.min:u.max):e&&(n=Math.max(h.width/p.width,h.height/p.height),t=null!==r.data.boundZoom?r.data.boundZoom:n,y.call(r,t)),a(u)}function M(e){if(4!==e.length)throw"Croppie - Invalid number of points supplied: "+e;var t=this,n=e[2]-e[0],i=t.elements.viewport.getBoundingClientRect(),o=t.elements.boundary.getBoundingClientRect(),r={left:i.left-o.left,top:i.top-o.top},a=i.width/n,l=e[1],u=e[0],c=-1*e[1]+r.top,h=-1*e[0]+r.left,p={};p[q]=u+"px "+l+"px",p[K]=new ee(h,c,a).toString(),s(t.elements.preview,p),y.call(t,a),t._currentZoom=a}function I(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),i=e.elements.boundary.getBoundingClientRect(),o=n.left-i.left,r=n.top-i.top,a=o-(t.width-n.width)/2,l=r-(t.height-n.height)/2,u=new ee(a,l,e._currentZoom);s(e.elements.preview,K,u.toString())}function X(e){var t=this,n=t.elements.canvas,i=t.elements.img,o=n.getContext("2d"),r=g.call(t);e=t.options.enableOrientation&&e;if(o.clearRect(0,0,n.width,n.height),n.width=i.width,n.height=i.height,r&&!e){var a=m(i);f(n,i,h(a||0,10))}else e&&f(n,i,e)}function Y(e){var t=this,n=e.points,i=h(n[0]),o=h(n[1]),r=h(n[2]),a=h(n[3]),s=r-i,l=a-o,u=e.circle,c=document.createElement("canvas"),p=c.getContext("2d"),d=0,m=0,f=e.outputWidth||s,v=e.outputHeight||l;e.outputWidth&&e.outputHeight;return c.width=f,c.height=v,e.backgroundColor&&(p.fillStyle=e.backgroundColor,p.fillRect(0,0,f,v)),!1!==t.options.enforceBoundary&&(s=Math.min(s,t._originalImageWidth),l=Math.min(l,t._originalImageHeight)),p.drawImage(this.elements.preview,i,o,s,l,d,m,f,v),u&&(p.fillStyle="#fff",p.globalCompositeOperation="destination-in",p.beginPath(),p.arc(c.width/2,c.height/2,c.width/2,0,2*Math.PI,!0),p.closePath(),p.fill()),c}function F(e){var t=e.points,n=document.createElement("div"),i=document.createElement("img"),o=t[2]-t[0],r=t[3]-t[1];return l(n,"croppie-result"),n.appendChild(i),s(i,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),i.src=e.url,s(n,{width:o+"px",height:r+"px"}),n}function W(e){return Y.call(this,e).toDataURL(e.format,e.quality)}function k(e){var t=this;return new Promise(function(n,i){Y.call(t,e).toBlob(function(e){n(e)},e.format,e.quality)})}function A(e){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(t){e.classList.add(t)}),this.elements.img.parentNode.replaceChild(e,this.elements.img),this.elements.preview=e),this.elements.img=e}function O(e,t){var n,i=this,o=[],r=null,a=g.call(i);if("string"==typeof e)n=e,e={};else if(Array.isArray(e))o=e.slice();else{if(void 0===e&&i.data.url)return Z.call(i),B.call(i),null;n=e.url,o=e.points||[],r=void 0===e.zoom?null:e.zoom}return i.data.bound=!1,i.data.url=n||i.data.url,i.data.boundZoom=r,p(n,a).then(function(n){if(A.call(i,n),o.length)i.options.relative&&(o=[o[0]*n.naturalWidth/100,o[1]*n.naturalHeight/100,o[2]*n.naturalWidth/100,o[3]*n.naturalHeight/100]);else{var r,a,s=d(n),l=i.elements.viewport.getBoundingClientRect(),u=l.width/l.height,c=s.width/s.height;c>u?(a=s.height,r=a*u):(r=s.width,a=s.height/u);var h=(s.width-r)/2,p=(s.height-a)/2,m=h+r,f=p+a;i.data.points=[h,p,m,f]}i.data.points=o.map(function(e){return parseFloat(e)}),i.options.useCanvas&&X.call(i,e.orientation||1),Z.call(i),B.call(i),t&&t()}).catch(function(e){console.error("Croppie:"+e)})}function j(e,t){return parseFloat(e).toFixed(t||0)}function H(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),i=n.left-t.left,o=n.top-t.top,r=(n.width-e.elements.viewport.offsetWidth)/2,a=(n.height-e.elements.viewport.offsetHeight)/2,s=i+e.elements.viewport.offsetWidth+r,l=o+e.elements.viewport.offsetHeight+a,u=e._currentZoom;(u===1/0||isNaN(u))&&(u=1);var c=e.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return i=Math.max(c,i/u),o=Math.max(c,o/u),s=Math.max(c,s/u),l=Math.max(c,l/u),{points:[j(i),j(o),j(s),j(l)],zoom:u,orientation:e.data.orientation}}function N(e){var t,n=this,r=H.call(n),a=i(o(ie),o(e)),s="string"==typeof e?e:a.type||"base64",l=a.size||"viewport",u=a.format,c=a.quality,h=a.backgroundColor,p="boolean"==typeof a.circle?a.circle:"circle"===n.options.viewport.type,d=n.elements.viewport.getBoundingClientRect(),m=d.width/d.height;return"viewport"===l?(r.outputWidth=d.width,r.outputHeight=d.height):"object"==typeof l&&(l.width&&l.height?(r.outputWidth=l.width,r.outputHeight=l.height):l.width?(r.outputWidth=l.width,r.outputHeight=l.width/m):l.height&&(r.outputWidth=l.height*m,r.outputHeight=l.height)),oe.indexOf(u)>-1&&(r.format="image/"+u,r.quality=c),r.circle=p,r.url=n.data.url,r.backgroundColor=h,t=new Promise(function(e,t){switch(s.toLowerCase()){case"rawcanvas":e(Y.call(n,r));break;case"canvas":case"base64":e(W.call(n,r));break;case"blob":k.call(n,r).then(e);break;default:e(F.call(n,r))}}),t}function S(){Z.call(this)}function P(e){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var t=this,i=t.elements.canvas;t.data.orientation=n(t.data.orientation,e),f(i,t.elements.img,t.data.orientation),z.call(t),x.call(t),copy=null}function D(){var e=this;e.element.removeChild(e.elements.boundary),u(e.element,"croppie-container"),e.options.enableZoom&&e.element.removeChild(e.elements.zoomerWrap),delete e.elements}function T(e,t){if(e.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=e,this.options=i(o(T.defaults),t),"img"===this.element.tagName.toLowerCase()){var n=this.element;l(n,"cr-original-image"),c(n,{"aria-hidden":"true",alt:""});var r=document.createElement("div");this.element.parentNode.appendChild(r),r.appendChild(n),this.element=r,this.options.url=this.options.url||n.src}if(v.call(this),this.options.url){var a={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,O.call(this,a)}}"function"!=typeof Promise&&function(e){function t(e,t){return function(){e.apply(t,arguments)}}function n(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(e,t(o,this),t(r,this))}function i(e){var t=this;return null===this._state?void this._deferreds.push(e):void c(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void e.reject(t)}e.resolve(i)}else(t._state?e.resolve:e.reject)(t._value)})}function o(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void l(t(n,e),t(o,this),t(r,this))}this._state=!0,this._value=e,a.call(this)}catch(e){r.call(this,e)}}function r(e){this._state=!1,this._value=e,a.call(this)}function a(){for(var e=0,t=this._deferreds.length;t>e;e++)i.call(this,this._deferreds[e]);this._deferreds=null}function s(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function l(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(e){if(i)return;i=!0,n(e)}}var u=setTimeout,c="function"==typeof setImmediate&&setImmediate||function(e){u(e,1)},h=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};n.prototype.catch=function(e){return this.then(null,e)},n.prototype.then=function(e,t){var o=this;return new n(function(n,r){i.call(o,new s(e,t,n,r))})},n.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&h(arguments[0])?arguments[0]:arguments);return new n(function(t,n){function i(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){i(r,e)},n)}e[r]=a,0==--o&&t(e)}catch(e){n(e)}}if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)i(r,e[r])})},n.resolve=function(e){return e&&"object"==typeof e&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,n){n(e)})},n.race=function(e){return new n(function(t,n){for(var i=0,o=e.length;o>i;i++)e[i].then(t,n)})},n._setImmediateFn=function(e){c=e},"undefined"!=typeof module&&module.exports?module.exports=n:e.Promise||(e.Promise=n)}(this),"function"!=typeof window.CustomEvent&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),o=i.length,r=new Uint8Array(o),a=0;a<o;a++)r[a]=i.charCodeAt(a);e(new Blob([r],{type:t||"image/png"}))}});var q,K,U,$=["Webkit","Moz","ms"],Q=document.createElement("div").style,G=[1,8,3,6],J=[2,7,4,5];K=t("transform"),q=t("transformOrigin"),U=t("userSelect");var V={translate3d:{suffix:", 0px"},translate:{suffix:""}},ee=function(e,t,n){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(n)};ee.parse=function(e){return e.style?ee.parse(e.style[K]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?ee.fromMatrix(e):ee.fromString(e)},ee.fromMatrix=function(e){var t=e.substring(7).split(",");return t.length&&"none"!==e||(t=[1,0,0,1,0,0]),new ee(h(t[4]),h(t[5]),parseFloat(t[0]))},ee.fromString=function(e){var t=e.split(") "),n=t[0].substring(T.globals.translate.length+1).split(","),i=t.length>1?t[1].substring(6):1,o=n.length>1?n[0]:0,r=n.length>1?n[1]:0;return new ee(o,r,i)},ee.prototype.toString=function(){var e=V[T.globals.translate].suffix||"";return T.globals.translate+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var te=function(e){if(!e||!e.style[q])return this.x=0,void(this.y=0);var t=e.style[q].split(" ");this.x=parseFloat(t[0]),this.y=parseFloat(t[1])};te.prototype.toString=function(){return this.x+"px "+this.y+"px"};var ne=r(_,500),ie={type:"canvas",format:"png",quality:1},oe=["jpeg","webp","png"];if(window.jQuery){var re=window.jQuery;re.fn.croppie=function(e){var t=typeof e;if("string"===t){var n=Array.prototype.slice.call(arguments,1),i=re(this).data("croppie");return"get"===e?i.get():"result"===e?i.result.apply(i,n):"bind"===e?i.bind.apply(i,n):this.each(function(){var t=re(this).data("croppie");if(t){var i=t[e];if(!re.isFunction(i))throw"Croppie "+e+" method not found";i.apply(t,n),"destroy"===e&&re(this).removeData("croppie")}})}return this.each(function(){var t=new T(this,e);t.$=re,re(this).data("croppie",t)})}}T.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},T.globals={translate:"translate3d"},i(T.prototype,{bind:function(e,t){return O.call(this,e,t)},get:function(){var e=H.call(this),t=e.points;return this.options.relative&&(t[0]/=this.elements.img.naturalWidth/100,t[1]/=this.elements.img.naturalHeight/100,t[2]/=this.elements.img.naturalWidth/100,t[3]/=this.elements.img.naturalHeight/100),e},result:function(e){return N.call(this,e)},refresh:function(){return S.call(this)},setZoom:function(e){y.call(this,e),a(this.elements.zoomer)},rotate:function(e){P.call(this,e)},destroy:function(){return D.call(this)}}),e.Croppie=window.Croppie=T});