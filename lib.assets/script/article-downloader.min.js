function downloadArticle(){let t=$(".article-title").text(),e=$(".article-content").html(),i=$(".article-creator").text(),o="<div><h1>"+t+"</h1>\r\n<div>"+i+"</div>"+e+"</div>",l=$(o);l=convertImagesToBase64(l),e=l.html();let a='<style type="text/css">body{font-family:"Times New Roman", Times, serif; font-size:16px; position:relative;} table[border="1"]{border-collapse:collapse; box-sizing:border-box; max-width:100%;} table[border="1"] td{padding:4px 5px;} table[border="0"] td{padding:4px 0;} p, li{line-height:1.5;} a{color:#000000; text-decoration:none;} h1{font-size:30px;} h2{font-size:26px;} h3{font-size:22px;} h4{font-size:16px;}</style>';e='<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>'+t+"</title>"+a+'</head><body style="position:relative;">'+e+"</body></html>";let n=htmlDocx.asBlob(e);saveAs(n,t+".docx")}function convertImagesToBase64(t){let e=t.find("img"),i=document.createElement("canvas"),o=i.getContext("2d");return[].forEach.call(e,function(t){let e=t;o.clearRect(0,0,i.width,i.height),i.width=e.width,i.height=e.height,o.drawImage(e,0,0,e.width,e.height);let l=i.toDataURL();e.setAttribute("src",l),e.style.width=i.width+"px",e.style.maxWidth="100%",e.style.height="auto",e.removeAttribute("height")}),i.remove(),t}