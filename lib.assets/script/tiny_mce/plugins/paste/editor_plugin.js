!function(){function e(e,t){return e.getParam(t,n[t])}var t=tinymce.each,n={paste_auto_cleanup_on_paste:!0,paste_enable_default_filters:!0,paste_block_drop:!1,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:!1,paste_remove_styles:!1,paste_remove_styles_if_webkit:!0,paste_convert_middot_lists:!0,paste_convert_headers_to_strong:!1,paste_dialog_width:"720",paste_dialog_height:"400",paste_text_use_dialog:!1,paste_text_sticky:!1,paste_text_sticky_default:!1,paste_text_notifyalways:!1,paste_text_linebreaktype:"combined",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.PastePlugin",{init:function(n,s){function o(t,s){var o,a=n.dom;i.onPreProcess.dispatch(i,t),t.node=a.create("div",0,t.content),tinymce.isGecko&&(o=n.selection.getRng(!0)).startContainer==o.endContainer&&3==o.startContainer.nodeType&&1===t.node.childNodes.length&&/^(p|h[1-6]|pre)$/i.test(t.node.firstChild.nodeName)&&-1===t.content.indexOf("__MCE_ITEM__")&&a.remove(t.node.firstChild,!0),i.onPostProcess.dispatch(i,t),t.content=n.serializer.serialize(t.node,{getInner:1,forced_root_block:""}),!s&&n.pasteAsPlainText?(i._insertPlainText(t.content),e(n,"paste_text_sticky")||(n.pasteAsPlainText=!1,n.controlManager.setActive("pastetext",!1))):i._insert(t.content)}function a(e){function s(e){e.preventDefault()}var a,i,r,c,d,l,p=n.selection,g=n.dom,_=n.getBody();if((e.clipboardData||g.doc.dataTransfer)&&(l=(e.clipboardData||g.doc.dataTransfer).getData("Text"),n.pasteAsPlainText))return e.preventDefault(),void o({content:g.encode(l).replace(/\r?\n/g,"<br />")});if(!g.get("_mcePaste")){if(a=g.add(_,"div",{id:"_mcePaste",class:"mcePaste","data-mce-bogus":"1"},"\ufeff\ufeff"),d=_!=n.getDoc().body?g.getPos(n.selection.getStart(),_).y:_.scrollTop+g.getViewPort(n.getWin()).y,g.setStyles(a,{position:"absolute",left:tinymce.isGecko?-40:0,top:d-25,width:1,height:1,overflow:"hidden"}),tinymce.isIE)return c=p.getRng(),(r=g.doc.body.createTextRange()).moveToElementText(a),r.execCommand("Paste"),g.remove(a),"\ufeff\ufeff"===a.innerHTML?(n.execCommand("mcePasteWord"),void e.preventDefault()):(p.setRng(c),p.setContent(""),setTimeout(function(){o({content:a.innerHTML})},0),tinymce.dom.Event.cancel(e));g.bind(n.getDoc(),"mousedown",s),g.bind(n.getDoc(),"keydown",s),i=n.selection.getRng(),a=a.firstChild,(r=n.getDoc().createRange()).setStart(a,0),r.setEnd(a,2),p.setRng(r),window.setTimeout(function(){var e,a="";g.select("div.mcePaste > div.mcePaste").length?a="<p>"+g.encode(l).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>":(e=g.select("div.mcePaste"),t(e,function(e){var n=e.firstChild;n&&"DIV"==n.nodeName&&n.style.marginTop&&n.style.backgroundColor&&g.remove(n,1),t(g.select("span.Apple-style-span",e),function(e){g.remove(e,1)}),t(g.select("br[data-mce-bogus]",e),function(e){g.remove(e)}),"mcePaste"!=e.parentNode.className&&(a+=e.innerHTML)})),t(g.select("div.mcePaste"),function(e){g.remove(e)}),i&&p.setRng(i),o({content:a}),g.unbind(n.getDoc(),"mousedown",s),g.unbind(n.getDoc(),"keydown",s)},0)}}var i=this;i.editor=n,i.url=s,i.onPreProcess=new tinymce.util.Dispatcher(i),i.onPostProcess=new tinymce.util.Dispatcher(i),i.onPreProcess.add(i._preProcess),i.onPostProcess.add(i._postProcess),i.onPreProcess.add(function(e,t){n.execCallback("paste_preprocess",e,t)}),i.onPostProcess.add(function(e,t){n.execCallback("paste_postprocess",e,t)}),n.onKeyDown.addToTop(function(e,t){if((tinymce.isMac?t.metaKey:t.ctrlKey)&&86==t.keyCode||t.shiftKey&&45==t.keyCode)return!1}),n.pasteAsPlainText=e(n,"paste_text_sticky_default"),n.addCommand("mceInsertClipboardContent",function(e,t){o(t,!0)}),e(n,"paste_text_use_dialog")||n.addCommand("mcePasteText",function(t,s){n.windowManager.open({file:i.url+"/pastetext.htm",width:parseInt(e(n,"paste_dialog_width")),height:parseInt(e(n,"paste_dialog_height")),inline:1})}),n.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"}),n.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"}),e(n,"paste_auto_cleanup_on_paste")&&(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?n.onKeyDown.addToTop(function(e,t){((tinymce.isMac?t.metaKey:t.ctrlKey)&&86==t.keyCode||t.shiftKey&&45==t.keyCode)&&a(t)}):n.onPaste.addToTop(function(e,t){return a(t)})),n.onInit.add(function(){n.controlManager.setActive("pastetext",n.pasteAsPlainText),e(n,"paste_block_drop")&&n.dom.bind(n.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(e){return e.preventDefault(),e.stopPropagation(),!1})}),i._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(n,s){function o(e){t(e,function(e){d=e.constructor==RegExp?d.replace(e,""):d.replace(e[0],e[1])})}function a(e,t){if("all"===r)return"";var n=l(p(t.replace(/^(["'])(.*)\1$/,"$2")," "),function(e){return/^(?!mso)/i.test(e)});return n.length?' class="'+n.join(" ")+'"':""}var i,r,c=this.editor,d=s.content,l=tinymce.grep,p=tinymce.explode,g=tinymce.trim;if(0!=c.settings.paste_enable_default_filters){if(tinymce.isIE&&document.documentMode>=9&&/<(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)/.test(s.content)&&(o([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]),o([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])),/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(d)||s.wordContent){s.wordContent=!0,o([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]),e(c,"paste_convert_headers_to_strong")&&(d=d.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")),e(c,"paste_convert_middot_lists")&&o([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]),o([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "]]);do{i=d.length,d=d.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1")}while(i!=d.length);0==e(c,"paste_retain_style_properties").replace(/^none$/i,"").length?d=d.replace(/<\/?span[^>]*>/gi,""):o([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(e,t){return t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(e,n,s){var o=[],a=0,i=p(g(s).replace(/&quot;/gi,"'"),";");return t(i,function(e){function t(e){return e+("0"!==e&&/\d$/.test(e))?"px":""}var n,s,i=p(e,":");if(2==i.length){switch(n=i[0].toLowerCase(),s=i[1].toLowerCase(),n){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":return void(o[a++]=n.replace(/^mso-|-alt$/g,"")+":"+t(s));case"horiz-align":return void(o[a++]="text-align:"+s);case"vert-align":return void(o[a++]="vertical-align:"+s);case"font-color":case"mso-foreground":return void(o[a++]="color:"+s);case"mso-background":case"mso-highlight":return void(o[a++]="background:"+s);case"mso-default-height":return void(o[a++]="min-height:"+t(s));case"mso-default-width":return void(o[a++]="min-width:"+t(s));case"mso-padding-between-alt":return void(o[a++]="border-collapse:separate;border-spacing:"+t(s));case"text-line-through":return void("single"!=s&&"double"!=s||(o[a++]="text-decoration:line-through"));case"mso-zero-height":return void("yes"==s&&(o[a++]="display:none"))}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(n))return;o[a++]=n+":"+i[1]}}),a>0?n+' style="'+o.join(";")+'"':n}]])}e(c,"paste_convert_headers_to_strong")&&o([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]),o([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]),"none"!==(r=e(c,"paste_strip_class_attributes"))&&(d=d.replace(/ class="([^"]+)"/gi,a),d=d.replace(/ class=([\-\w]+)/gi,a)),e(c,"paste_remove_spans")&&(d=d.replace(/<\/?span[^>]*>/gi,"")),s.content=d}},_postProcess:function(n,s){var o,a=this,i=a.editor,r=i.dom;0!=i.settings.paste_enable_default_filters&&(s.wordContent&&(t(r.select("a",s.node),function(e){e.href&&-1==e.href.indexOf("#_Toc")||r.remove(e,1)}),e(i,"paste_convert_middot_lists")&&a._convertLists(n,s),o=e(i,"paste_retain_style_properties"),tinymce.is(o,"string")&&"all"!==o&&"*"!==o&&(o=tinymce.explode(o.replace(/^none$/i,"")),t(r.select("*",s.node),function(e){var t,n,s,a={},i=0;if(o)for(t=0;t<o.length;t++)n=o[t],(s=r.getStyle(e,n))&&(a[n]=s,i++);r.setAttrib(e,"style",""),o&&i>0?r.setStyles(e,a):"SPAN"!=e.nodeName||e.className||r.remove(e,!0)}))),e(i,"paste_remove_styles")||e(i,"paste_remove_styles_if_webkit")&&tinymce.isWebKit?t(r.select("*[style]",s.node),function(e){e.removeAttribute("style"),e.removeAttribute("data-mce-style")}):tinymce.isWebKit&&t(r.select("*",s.node),function(e){e.removeAttribute("data-mce-style")}))},_convertLists:function(e,n){var s,o,a,i,r,c=e.editor.dom,d=-1,l=[];t(c.select("p",n.node),function(e){var n,r,p,g,_,u="";for(n=e.firstChild;n&&3==n.nodeType;n=n.nextSibling)u+=n.nodeValue;u=e.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g," "),/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(u)&&(r="ul"),/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(u)&&(r="ol"),r?((a=parseFloat(e.style.marginLeft||0))>d&&l.push(a),s&&r==i?a>d?s=o.appendChild(c.create(r)):a<d&&(g=tinymce.inArray(l,a),_=c.getParents(s.parentNode,r),s=_[_.length-1-g]||s):(s=c.create(r),c.insertAfter(s,e)),t(c.select("span",e),function(e){var t=e.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");"ul"==r&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(t)?c.remove(e):/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(t)&&c.remove(e)}),p=e.innerHTML,p="ul"==r?e.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):e.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,""),o=s.appendChild(c.create("li",0,p)),c.remove(e),d=a,i=r):s=d=0}),-1!=(r=n.node.innerHTML).indexOf("__MCE_ITEM__")&&(n.node.innerHTML=r.replace(/__MCE_ITEM__/g,""))},_insert:function(e,t){var n=this.editor,s=n.selection.getRng();n.selection.isCollapsed()||s.startContainer==s.endContainer||n.getDoc().execCommand("Delete",!1,null),n.execCommand("mceInsertContent",!1,e,{skip_undo:t})},_insertPlainText:function(n){function s(e){t(e,function(e){n=e.constructor==RegExp?n.replace(e,""):n.replace(e[0],e[1])})}var o=this.editor,a=e(o,"paste_text_linebreaktype"),i=e(o,"paste_text_replacements"),r=tinymce.is;"string"==typeof n&&n.length>0&&(s(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(n)?[/[\n\r]+/g]:[/\r+/g]),s([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"]]),n=o.dom.decode(tinymce.html.Entities.encodeRaw(n)),r(i,"array")?s(i):r(i,"string")&&s(new RegExp(i,"gi")),s("none"==a?[[/\n+/g," "]]:"br"==a?[[/\n/g,"<br />"]]:"p"==a?[[/\n+/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"]]:[[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]),o.execCommand("mceInsertContent",!1,n))},_legacySupport:function(){var t=this,n=t.editor;n.addCommand("mcePasteWord",function(){n.windowManager.open({file:t.url+"/pasteword.htm",width:parseInt(e(n,"paste_dialog_width")),height:parseInt(e(n,"paste_dialog_height")),inline:1})}),e(n,"paste_text_use_dialog")&&n.addCommand("mcePasteText",function(){n.windowManager.open({file:t.url+"/pastetext.htm",width:parseInt(e(n,"paste_dialog_width")),height:parseInt(e(n,"paste_dialog_height")),inline:1})}),n.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}}),tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)}();