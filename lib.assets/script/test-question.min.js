function activateSortOrder(){$("#sortable").sortable({placeholder:"ui-state-highlight",forcePlaceholderSize:!0,revert:!0,change:function(t,e){},stop:function(t,e){let n=[];$("#sortable > li").each(function(t,e){n.push($(this).attr("data-question-id"))}),$.post("ajax-sort-question.php",{array_question:n.join(","),sort:"yes"},function(t){})}}),$("#sortable").disableSelection()}function save_competence(t){let e=t.attr("data-question-id"),n=t.val(),a=t.closest(".kd-ctrl");t.replaceWith('<span data-question-id"'+e+'">'+n+"</span>"),a.attr("data-focus","false"),$.post("ajax-update-competence.php",{save:"save",question_id:e,value:n},function(t){})}function testImage(t,e){let n=new Image;n.addEventListener("error",function(){}),n.src=t}function downloadInWord(){let t=$(".test-question")[0].outerHTML,e=$(t);$(e).find(" > li").each(function(t,e){$(this).append("<br>")}),$(e).find(".question-edit-ctrl").remove(),$(e).find(".option-circle").remove(),e=convertImagesToBase64(e);let n=e[0].outerHTML,a=htmlDocx.asBlob("<!DOCTYPE html>"+n,{orientation:"portrait"});saveAs(a,test_name+".docx")}function convertImagesToBase64(t){let e=t.find("img"),n=document.createElement("canvas"),a=n.getContext("2d");return[].forEach.call(e,function(t){let e=t;a.clearRect(0,0,n.width,n.height),n.width=e.width,n.height=e.height,a.drawImage(e,0,0,e.width,e.height);let o=n.toDataURL();e.setAttribute("src",o)}),n.remove(),t}function distribution(t){$.get("ajax-question-distribution.php",{test_id:t},function(t){let e=$(t);e.css({opacity:0}),e.css({width:"300px"}),$("body").append(e);let n=e.height(),a='<div id="basic-competence-distribution"></div>';overlayDialog(a,300,n),$("#basic-competence-distribution").empty().append(e),e.css({opacity:1})})}document.addEventListener("DOMContentLoaded",function(){function t(t,e,n,a){let o=document.createElement("canvas"),i=o.getContext("2d");o.width=e,o.height=n;for(let t=0;t<e;t++)for(let e=0;e<n;e++){let n=Math.floor(255*Math.random());i.fillStyle="rgba("+n+","+n+","+n+","+a+")",i.fillRect(t,e,1,1)}t.style.background="url("+o.toDataURL("image/png")+")"}t(document.getElementsByTagName("body")[0],50,50,.02)},!1),window.onload=function(){$(".deletequestion").click(function(){return confirm("Apakah Anda akan menghapus soal ini beserta dengan seluruh pilihannya?")}),$(".test-question > li").each(function(t,e){$(this).attr("data-no",t+1).addClass("nomor")}),$(".test-question img").each(function(t,e){let n=$(this).closest(".nomor").attr("data-no");testImage($(this).attr("src"),n)}),$(document).on("click",".kd-ctrl a",function(t){let e=$(this).attr("data-question-id"),n=$(this).find("span"),a=n.text().trim();n.replaceWith('<input type="text" value="'+a+'" data-question-id="'+e+'" class="kd-ctrl-input">'),$(this).find("input").select(),$(this).closest(".kd-ctrl").attr("data-focus","true"),t.preventDefault()}),$(document).on("blur",".kd-ctrl-input",function(t){save_competence($(this))}),$(document).on("submit",'form[name="form1"]',function(t){t.preventDefault(),save_competence($(this).find(".kd-ctrl-input"))}),$(document).on("submit",'form[name="formrandom"]',function(t){let e={};$('form[name="formrandom"] tbody tr').each(function(t,n){let a=$(this),o="bc"+a.find(".take").attr("data-basic-competence"),i=a.find(".take").val();e[o]=i});let n=$('form[name="formrandom"] input[name="test_id"]').val();$.post("ajax-question-distribution.php",{save:"save",test_id:n,data:JSON.stringify(e)},function(t){}),closeOverlayDialog(),t.preventDefault()}),$(document).on("change blur keyup",'form[name="formrandom"] .take',function(t){let e=0;$('form[name="formrandom"] tbody tr').each(function(t,n){let a=$(this),o=parseInt(a.find(".take").val());e+=o}),$('form[name="formrandom"] .take_total').val(e)})};