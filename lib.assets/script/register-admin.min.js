function onChangeCountry(){let country_id=$("#country_id").val(),prefix=$("#country_id option:selected").attr("data-code");updatePhobeBackground(prefix),$("#phone_code").val(prefix),$.ajax({url:"../lib.ajax/ajax-load-state-list.php",type:"GET",dataType:"json",data:{country_id:country_id},success:function(data){$("#state_id").replaceWith('<select name="state_id" id="state_id" required="required" data-full-width="true"></select>'),$("#state_id").empty();let html="",i;for(i in html+='<option value="">- Pilih Provinsi -</option>',data)html+='<option value="'+data[i].l+'">'+data[i].l+"</option>";allow_add_state&&(html+='<option value="--">- Tambah Propinsi -</option>'),$("#state_id").append(html)}}),$.ajax({url:"../lib.ajax/ajax-load-city-list.php",type:"GET",dataType:"json",data:{country_id:country_id},success:function(data){$("#city_id").replaceWith('<select name="city_id" id="city_id" required="required" data-full-width="true"></select>'),$("#city_id").empty();let html="",i;for(i in html+='<option value="">- Pilih Kabupaten/Kota -</option>',data)html+='<option value="'+data[i].l+'">'+data[i].l+"</option>";allow_add_city&&(html+='<option value="--">- Tambah Kota -</option>'),$("#city_id").append(html)}})}function updatePhobeBackground(code){let canvas=document.getElementById("phonebg"),ctx=canvas.getContext("2d");ctx.clearRect(0,0,40,36),ctx.beginPath(),ctx.rect(0,0,40,30),ctx.fillStyle="#FAFAFA",ctx.fill(),ctx.beginPath(),ctx.fillStyle="#333333",ctx.strokeStyle="#888888",ctx.lineWidth=1,ctx.beginPath(),ctx.moveTo(40,0),ctx.lineTo(40,29),ctx.stroke(),ctx.font="12px Arial",ctx.textAlign="end",ctx.fillText(code,36,20);let dataURL=canvas.toDataURL();$("#phone").css({"background-image":"url("+dataURL+")","background-position":"-4px center","background-repeat":"no-repeat","padding-left":"40px"})}if($(document).ready((function(e){$(document).on("change","select#country_id",(function(e){onChangeCountry()})),$(document).on("change","select#state_id",(function(e){let val=$(this).val(),_this=this;if("--"==val)confirm("Apakah Anda akan mengubah jenis masukan?")&&($(_this).replaceWith('<input type="text" name="state_id" id="state_id" required="required" data-full-width="true">'),$("#state_id").select());else{let state_name=val,country_id=$("#country_id").val();$.ajax({url:"../lib.ajax/ajax-load-city-list.php",type:"GET",dataType:"json",data:{state_name:state_name,country_id:country_id},success:function(data){$("#city_id").replaceWith('<select name="city_id" id="city_id" required="required" data-full-width="true"></select>'),$("#city_id").empty();let html="",i;for(i in html+='<option value="">- Pilih Kota -</option>',data)html+='<option value="'+data[i].l+'">'+data[i].l+"</option>";allow_add_city&&(html+='<option value="--">- Tambah Kota -</option>'),$("#city_id").append(html)}})}})),$(document).on("change","select#city_id",(function(e){let val,_this=this;"--"==$(this).val()&&confirm("Apakah Anda akan mengubah jenis masukan?")&&($(_this).replaceWith('<input type="text" name="city_id" id="city_id" required="required" data-full-width="true">'),$("#city_id").select())})),initRegisterForm()})),"undefined"==typeof Language){let Language={}}function initRegisterForm(){$(document).on("blur",'.registerform input[name="username"]',(function(){let that=$(this),val=that.val();$.ajax({url:"../lib.ajax/ajax-check-username.php",data:{username:val},type:"POST",dataType:"json",success:function(data){data.valid?(data.corrected?(that.val(data.corrected),that.removeClass("input-error")):that.addClass("input-error"),data.registered?that.addClass("input-error"):that.removeClass("input-error")):(""!=val&&alert("Email ini sudah terdaftar di Planetbiru."),that.addClass("input-error"),setTimeout((function(){that.val("")}),2e3))}})})),$(document).on("blur",'.registerform input[name="email"]',(function(){let that=$(this),val=that.val();$.ajax({url:"../lib.ajax/ajax-check-email.php",data:{email:val},type:"POST",dataType:"json",success:function(data){data.registered?(""!=val&&-1!=val.indexOf("@")&&alert("Email ini sudah terdaftar di Planetbiru."),that.addClass("input-error"),setTimeout((function(){that.val("")}),2e3)):that.removeClass("input-error")}})})),$(document).on("blur",'.registerform input[name="name"]',(function(){let that=$(this),val=that.val();$.ajax({url:"../lib.ajax/ajax-check-name.php",data:{name:val},type:"POST",dataType:"json",success:function(data){data.valid?that.removeClass("input-error"):that.addClass("input-error"),that.val(data.corrected)}})}))}function checkThisForm(frm){let that=$(frm),validForm=1;return that.find(":input").each((function(index,element){let required;$(this).hasClass("input-error")&&(validForm*=0),$(this).is("[required]")&&(($(this).is("select")||$(this).is('input[type="text"]')||$(this).is('input[type="password"]')||$(this).is('input[type="text"]'))&&""==$(this).val()&&(validForm*=0),$(this).is('input[type="radio"]')&&""==$(this).filter(":checked").val()&&(validForm*=0))})),!!validForm||(alert("Isian salah."),!1)}