function getNumberingType(e,t){let i,n=e.split(".")[0].trim(),a=t.split(".")[0].trim();return i="A"==n&&"B"==a?"upper-alpha":"a"==n&&"b"==a?"lower-alpha":"I"==n&&"II"==a?"upper-roman":"i"==n&&"ii"==a?"lower-roman":"1"==n&&"2"==a?"decimal":"01"==n&&"02"==a?"decimal-leading-zero":"upper-alpha",i}function getNumType(e){for(let t in numberingList)if(numberingList.hasOwnProperty(t)){let t=[],i=-1;for(let n in e){let a=e[n];if(-1!==a.indexOf(".")){let e=a.trim.split(".",2),l=e[0].trim();-1!=$.inArray(l,type)&&n>i&&t.push(l)}}let n=matchNumberingType(t,numberingList);if(!1!==n)return n}return""}function matchNumberingType(e,t){for(let i in t){let n=t[i];if(e.length>1&&n[0]==e[0]&&n[1]==e[1])return i}return!1}function optionMatch(e,t){let i=numberingList[t];return void 0===i?-1:i.indexOf(e)}function parseQuestion(e){let t,i,n,a,l,o=[],r="",s="",d=[];for(t in d=e.split("\n"),d)d[t]=d[t].trimMask(" \r\n\t ");e=d.join("\n"),d=[],n=e,a=n.replaceAll("\\\\\n","<br />");let c=a.split("\n");if(c.length>=3){for(t in l=c[0],c)c[t]=c[t].trimMask(" \r\n\t ");t=1;do{if(r=getNumberingType(c[t],c[t+1]),t++,t>=c.length-2)break}while(""==r);for(t=1,i=-1;t<c.length-1;t++)c[t].indexOf(".")>-1?(d=c[t].splitWithLimit(".",2),s=d[0].trimMask(" \r\n\t "),optionMatch(s,r)>-1?(o.push({text:d[1].trimMask(" \r\n\t "),score:0}),i++):-1==i?l+="<br />"+c[t]:o[i].text+="<br />"+c[t]):-1==i?l+="<br />"+c[t]:o[i].text+="<br />"+c[t];if(c.length>3){let e=!0;if(c[c.length-1].countSubstring(":")==c[c.length-1].countSubstring("\\\\:")&&(e=!1),c[c.length-1].indexOf(":")>-1&&e){c[c.length-1]=c[c.length-1].replaceAll("\t"," "),d=c[c.length-1].splitWithLimit(":",2),s=d[1].trimMask(" \r\n\t "),s=s.split(" ")[0].trimMask(" \r\n\t ");let e=optionMatch(s,r);e>-1&&e<o.length?o[e].score=1:(d=c[c.length-1].splitWithLimit(".",2),s=d[0].trimMask(" \r\n\t "),optionMatch(s,r)>-1&&o.push({text:d[1].trimMask(" \r\n\t "),score:0}))}else c[c.length-1].indexOf(".")>-1&&(d=c[c.length-1].splitWithLimit(".",2),s=d[0].trimMask(" \r\n\t "),optionMatch(s,r)>-1&&o.push({text:d[1].trimMask(" \r\n\t "),score:0}))}}else o=[],r="upper-alpha",l=c[0];for(t in l.replaceAll("\\\\:",":"),o)o[t].text=o[t].text.replaceAll("\\\\:",":");return{question:l,options:o,numbering:r}}function createLineObject(e,t){let i=t.split("|").length-1,n=t.replace(/[^-\|]/gi,""),a=t.replace(/\s/g,""),l=n==a&&a.length>1;return{lineNumber:parseInt(e),content:t,pipe:i,pipeDash:l,startTable:!1,inTable:!1,endTable:!1}}function detectTable(e){var t=e,i=t.split("<br />"),n=t.split("<br />"),a=[];for(let e in i)n[e]=i[e].trim(),a[e]=createLineObject(e,n[e]);let l=!1,o=[];for(let e=1,t=0;e<a.length;e++)a[e].pipeDash&&a[e-1].pipe>0&&(l=!0,a[e].inTable=!0,a[e-1].startTable=!0,o[t]=[],o[t].push(a[e-1]),o[t].push(a[e])),l&&!a[e].pipeDash&&a[e].pipe>0&&(a[e].inTable=!0,o[t].push(a[e]),e==a.length-1&&(a[e].endTable=!0)),l&&0==a[e].pipe&&(l=!1,a[e-1].endTable=!0,t++);for(let e in i)i[e]=i[e]+"<br />";for(let e in o){let t=o[e];for(let e in t){let n="";t[e].startTable?n=createTableHeader(t[e].content):t[e].inTable&&(n=t[e].pipeDash?"":t[e].endTable?createTableContent(t[e].content)+"</tbody></table>":createTableContent(t[e].content)),i[t[e].lineNumber]=n}}return i.join("")}function createTableHeader(e){e=e.trim();var t=e.split("|");let i='<table border="1"><thead><tr>';for(let e=0;e<t.length;e++)(0==e&&""!=t[e]||e==t.length-1&&""!=t[e]||""!=t[e])&&(i+="<td>"+t[e]+"</td>");return i+="</tr></thead><tbody>",i}function createTableContent(e){e=e.trim();var t=e.split("|");let i="<tr>";for(let e=0;e<t.length;e++)(0==e&&""!=t[e]||e==t.length-1&&""!=t[e]||""!=t[e])&&(i+="<td>"+t[e]+"</td>");return i+="</tr>",i}function rTrim(e,t){return-1!==e.indexOf(t)&&e.substring(e.length-t.length)==t?e.substring(0,e.length-t.length):e}function buldOptionHTML(e,t,i){let n,a;t=t||!1,i=i||"";let l="",o="";for(n in void 0===e.numbering&&(e.numbering="upper-alpha"),l+='\r\n\t<ol class="option-ol" start="'+numberingList[e.numbering][0]+'" style="list-style-type:'+e.numbering+'">',e.options){a=e.options[n],o=a.score>0?'<span class="score"></span>':"";let r=a.text;r=detectTable(r);let s=r.escapeHTMLEntities().restoreBR().addImage(t,i).restoreTableEntity();l+='\r\n\t\t<li class="option-li">'+o+"<span>"+s+"</span></li>"}return l+="\r\n\t</ol>",l}function buildQuestionHTML(e,t,i){let n;t=t||!1,i=i||"";let a="";if(null!=e&&e.length>0){for(n in a+='\r\n<ol class="question-ol">',e){let l=e[n].question;l=detectTable(l);let o=l.escapeHTMLEntities().restoreBR().addImage(t,i).restoreTableEntity();a+="\r\n\t<li><span>"+o+"</span>"+buldOptionHTML(e[n],t,i)+"\r\n\t</li>"}a+="\r\n</ol>"}return a}function buildQuestion(e){let t,i,n;for(t=e.toString(),i=t.replaceAll("\r\n","\n");i.indexOf("\n\n\n")>-1;)i=i.replaceAll("\n\n\n","\n\n");if(i=i.trimMask(" \r\n\t "),i.length>0){let e=i.split("\n\n"),t=[];for(let i in e)n=e[i].trimMask(" \r\n\t "),""!=n&&t.push(parseQuestion(n));return t}return null}function getYouTubeParams(e){e=e.toString();let t=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);return null!=t?{video_id:t[1],url:e}:null}function getInputSelection(e){let t,i,n,a,l,o=0,r=0;return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?(o=e.selectionStart,r=e.selectionEnd):(i=document.selection.createRange(),i&&i.parentElement()==e&&(a=e.value.length,t=e.value.replace(/\r\n/g,"\n"),n=e.createTextRange(),n.moveToBookmark(i.getBookmark()),l=e.createTextRange(),l.collapse(!1),n.compareEndPoints("StartToEnd",l)>-1?o=r=a:(o=-n.moveStart("character",-a),o+=t.slice(0,o).split("\n").length-1,n.compareEndPoints("EndToEnd",l)>-1?r=a:(r=-n.moveEnd("character",-a),r+=t.slice(0,r).split("\n").length-1)))),{start:o,end:r}}function noAnswer(e){let t,i,n,a,l=[];if(null!=e)for(t in e){for(n in i=e[t].options,a=0,i)a+=i[n].score;0==a&&l.push(parseInt(t)+1)}return l}function inputChanged(e){let t=e.target,i=document.getElementById("preview2"),n=document.getElementById("status");renderQuestion(t,i,n)}function renderQuestion(e,t,i){let n=e.value,a=t,l=buildQuestion(n);a.innerHTML=buildQuestionHTML(l,parseImg,baseIMGURL),$("#preview2 > ol > li:first-child").attr("value",startFrom);let o=noAnswer(l);if(null==l)i.innerHTML="";else{let e=l.length;if(modContinue){let t;for(t=0;t<o.length;t++)o[t]+=startFrom-1;e+=startFrom-1}let t="";t="Jumlah soal: "+e,o.length&&(t+=" | Tanpa jawaban: Nomor "+o.join(", ")),i.innerHTML=t}}function saveFileData(name,value){let fls=window.localStorage.getItem("filelist")||"[]";fileNameList=eval(fls),-1==fileNameList.indexOf(currentFileName)&&fileNameList.push(currentFileName),window.localStorage.setItem("filelist",JSON.stringify(fileNameList)),window.localStorage.setItem("data_"+name,value),contentModified=!1}function loadFileData(e){let t=window.localStorage.getItem("data_"+e)||"";document.getElementById("input").value=t,document.getElementById("input").focus(),contentModified=!1}function writeFile(){let e=document.getElementById("filename").value;if(e=e.trim(),e=e.replace(/[^0-9A-Za-z_\-\(\)]/gi," "),e=e.replace(/ {1,}/g," ").trim(),""==e)alert("Silakan masukkan nama file"),document.getElementById("filename").select();else{currentFileName=e;let t=document.getElementById("input").value;saveFileData(currentFileName,t),closeDialogFile()}}function selectFileList(e){document.getElementById("filename").value=e}function showEquationDialog(){let e='<div class="file-dialog" style="width:800px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeEquationDialog();"><span></span></a><span id="file-dialog-title-label">Masukkan Persamaan</span></div>\r\n    <div id="equation-area" style="position:relative; height:480px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$("#equation-area").html('<iframe src="equation.html" frameborder="0" style="padding:0;margin:0;width:100%;height:500px;"></iframe>')}function showChemistryDialog(){let e='<div class="file-dialog" style="width:800px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeChemistryDialog();"><span></span></a><span id="file-dialog-title-label">Editor Molekul</span></div>\r\n    <div id="kekule-area" style="position:relative; height:480px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$("#kekule-area").html('<iframe src="chem-editor.html" frameborder="0" style="padding:0;margin:0;width:100%;height:500px;"></iframe>')}function showLatexDialog(){let e=$("#input")[0],t=getInputSelection(e),i=e.value,n=t.start,a=t.end,l=i.substr(n,a-n);l=l.trim();let o='<div class="file-dialog" style="width:640px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeEquationDialog();"><span></span></a><span id="file-dialog-title-label">Masukkan Persamaan</span></div>\r\n    <div id="equation-area" style="position:relative; height:352px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',r=document.getElementById("dialog-area");r.innerHTML=o,r.setAttribute("data-dialog-shown","true");let s="latex.html#arg="+encodeURIComponent(l);$("#equation-area").html('<iframe src="'+s+'" frameborder="0" style="padding:0;margin:0;width:100%;height:400px;"></iframe>')}function showTableDialog(){let e=$("#input")[0],t=getInputSelection(e),i=e.value,n=t.start,a=t.end,l=i.substr(n,a-n),o='<div class="file-dialog" style="width:640px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeEquationDialog();"><span></span></a><span id="file-dialog-title-label">Masukkan Tabel</span></div>\r\n    <div id="equation-area" style="position:relative; height:352px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',r=document.getElementById("dialog-area");r.innerHTML=o,r.setAttribute("data-dialog-shown","true");let s="table.html#"+LZString.compressToBase64(l);$("#equation-area").html('<iframe id="iframetable" src="'+s+'" frameborder="0" style="padding:0;margin:0;width:100%;height:400px;"></iframe>')}function showSuperscriptDialog(){let e='<div class="file-dialog" style="width:680px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeEquationDialog();"><span></span></a><span id="file-dialog-title-label">Masukkan Superscript</span></div>\r\n    <div id="equation-area" style="position:relative; height:372px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$("#equation-area").html('<iframe src="superscript.html" frameborder="0" style="padding:0;margin:0;width:100%;height:400px;"></iframe>')}function showSubscriptDialog(){let e='<div class="file-dialog" style="width:680px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeEquationDialog();"><span></span></a><span id="file-dialog-title-label">Masukkan Subscript</span></div>\r\n    <div id="equation-area" style="position:relative; height:372px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$("#equation-area").html('<iframe src="subscript.html" frameborder="0" style="padding:0;margin:0;width:100%;height:400px;"></iframe>')}function showSubSuperscriptDialog(){let e='<div class="file-dialog" style="width:600px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeEquationDialog();"><span></span></a><span id="file-dialog-title-label">Masukkan Subscript &amp; Superscript</span></div>\r\n    <div id="equation-area" style="position:relative; height:278px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$("#equation-area").html('<iframe src="subsuperscript.html" frameborder="0" style="padding:0;margin:0;width:100%;height:306px;"></iframe>')}function showSymbolDialog(){let e='<div class="file-dialog" style="width:680px">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeEquationDialog();"><span></span></a><span id="file-dialog-title-label">Masukkan Simbol</span></div>\r\n    <div id="equation-area" style="position:relative; height:372px; overflow:hidden;">\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$("#equation-area").html('<iframe src="symbol.html" frameborder="0" style="padding:0;margin:0;width:100%;height:400px;"></iframe>')}function insertEquation(e){insertAtCursor(document.getElementById("input"),e);let t=document.getElementById("input"),i=document.getElementById("preview2"),n=document.getElementById("status");renderQuestion(t,i,n),closeEquationDialog()}function insertHTML(e){insertAtCursor(document.getElementById("input"),e);let t=document.getElementById("input"),i=document.getElementById("preview2"),n=document.getElementById("status");renderQuestion(t,i,n),closeEquationDialog()}function closeEquationDialog(){let e=document.getElementById("dialog-area");e.setAttribute("data-dialog-shown","false"),setTimeout(function(){e.innerHTML=""},200)}function closeChemistryDialog(){closeEquationDialog()}function closeTableDialog(){closeEquationDialog()}function deleteFileFromStorage(){let filename=document.getElementById("filename").value;pbDialog({modal:!0,width:360,height:190,title:"Konfirmasi",content:"<p>Apakah Anda akan menghapus ujian ini?</p>",buttons:{Ya:function(){let i;filename=filename.trim(),filename=filename.replace(/[^0-9A-Za-z_\-\(\)]/gi," "),filename=filename.replace(/ {1,}/g," ").trim();let fls=window.localStorage.getItem("filelist")||"[]";"[null]"==fls&&(fls="[]"),fileNameList=eval(fls);let fls2=[];for(i in fileNameList)fileNameList[i]!=filename&&fls2.push(fileNameList[i]);window.localStorage.removeItem("data_"+filename),window.localStorage.setItem("filelist",JSON.stringify(fls2));let html="<ul>";for(i in fls2)html+="<li><a href=\"javascript:selectFileList('"+fls2[i]+"')\">"+fls2[i]+"</a></li>\r\n";html+="</ul>",document.getElementById("file-dialog-list").innerHTML=html,document.getElementById("filename").value="",closeDialog()},Tidak:function(){closeDialog()}}})}function deleteFile(){showDialogDeleteFile();let fls=window.localStorage.getItem("filelist")||"[]",i;fileNameList=eval(fls);let html="<ul>";for(i in fileNameList)html+='<li class="file-item"><a href="javascript:selectFileList(\''+fileNameList[i]+"')\">"+fileNameList[i]+"</a></li>\r\n";html+="</ul>",document.getElementById("file-dialog-list").innerHTML=html}function openFile(){showDialogOpenFile();let fls=window.localStorage.getItem("filelist")||"[]",i;fileNameList=eval(fls);let html="<ul>";for(i in fileNameList)html+='<li class="file-item"><a href="javascript:selectFileList(\''+fileNameList[i]+"')\">"+fileNameList[i]+"</a></li>\r\n";html+="</ul>",document.getElementById("file-dialog-list").innerHTML=html}function saveFileAs(){showDialogSaveFile(currentFileName);let fls=window.localStorage.getItem("filelist")||"[]",i;fileNameList=eval(fls);let html="<ul>";for(i in fileNameList)html+='<li class="file-item"><a href="javascript:selectFileList(\''+fileNameList[i]+"')\">"+fileNameList[i]+"</li>";html+="</ul>",document.getElementById("file-dialog-list").innerHTML=html}function loadFile(){let e=document.getElementById("filename").value;e=e.trim(),e=e.replace(/[^0-9A-Za-z_\-\(\)]/gi," "),e=e.replace(/ {1,}/g," ").trim(),""==e?(alert("Silakan masukkan nama file"),document.getElementById("filename").select()):(currentFileName=e,loadFileData(currentFileName),closeDialogFile())}function closeDialogFile(){closeEquationDialog()}function enterSign(){insertAtCursor(document.getElementById("input"),"\\\\\n")}function insertImageString(){let e=document.getElementById("filename").value;""==e?(alert("Silakan masukkan nama file"),document.getElementById("filename").select()):(insertAtCursor(document.getElementById("input"),"img:"+e+" "),closeDialogFile())}function insertAudioString(){let e=document.getElementById("filename").value;""==e?(alert("Silakan masukkan nama file"),document.getElementById("filename").select()):(insertAtCursor(document.getElementById("input"),"audio:"+e+"#text-top#300,40 "),closeDialogFile())}function uploadImage(){document.getElementById("image").click()}function uploadAudio(){document.getElementById("audio").click()}function uploadAudioCompress(){document.getElementById("audio2").click()}function insertImage(){let e='<div class="file-dialog">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeDialogFile();"><span></span></a><span id="file-dialog-title-label">Masukkan Gambar</span></div>\r\n    <div id="file-dialog-list"><div class="progressbar"><div class="progressbar-inner"></div></div>\r\n    <div id="remote-image-list">\r\n    </div>\r\n    </div>\r\n    <div class="file-dialog-control">\r\n    <div class="file-dialog-form">\r\n    \t <form name="filefrm" id="filefrm" onsubmit="insertImageString(); return false;">\r\n        \t <input type="text" name="filename" id="filename" autocomplete="off" style="width:calc(100% - 264px);">\r\n            <input type="button" name="openbtn" id="openbtn" value="Masukkan" onclick="insertImageString()">\r\n            <input type="button" name="uploadbtn" id="openbtn" value="Unggah" onclick="uploadImage()">\r\n            <input type="button" name="closebtn" id="closebtn" value="Batal" onclick="closeDialogFile()">\r\n        </form>\r\n    </div>\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$.get("ajax-load-image.php",{test_id:testID},function(e){$("#remote-image-list").html(e)}),initDragDropUpload()}function insertAudio(){let e='<div class="file-dialog">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeDialogFile();"><span></span></a><span id="file-dialog-title-label">Masukkan Suara</span></div>\r\n    <div id="file-dialog-list"><div class="progressbar"><div class="progressbar-inner"></div></div>\r\n    <div id="remote-image-list">\r\n    </div>\r\n    </div>\r\n    <div class="file-dialog-control">\r\n    <div class="file-dialog-form">\r\n    \t <form name="filefrm" id="filefrm" onsubmit="insertAudioString(); return false;">\r\n        \t <input type="text" name="filename" id="filename" autocomplete="off" style="width:calc(100% - 264px);">\r\n            <input type="button" name="openbtn" id="openbtn" value="Masukkan" onclick="insertAudioString()">\r\n            <input type="button" name="uploadbtn" id="openbtn" value="Unggah" onclick="uploadAudio()">\r\n            <input type="button" name="closebtn" id="closebtn" value="Batal" onclick="closeDialogFile()">\r\n        </form>\r\n    </div>\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$.get("ajax-load-audio.php",{test_id:testID},function(e){$("#remote-image-list").html(e)}),initDragDropUpload()}function compressAudio(){let e='<div class="file-dialog">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeDialogFile();"><span></span></a><span id="file-dialog-title-label">Kompres Suara</span></div>\r\n    <div id="file-dialog-list"><div class="progressbar"><div class="progressbar-inner"></div></div>\r\n    <div id="remote-image-list">\r\n    </div>\r\n    </div>\r\n    <div class="file-dialog-control">\r\n    <div class="file-dialog-form">\r\n    \t <form name="filefrm" id="filefrm" onsubmit="insertAudioString(); return false;">\r\n        \t <input type="text" name="filename" id="filename" autocomplete="off" style="width:calc(100% - 264px);">\r\n            <input type="button" name="openbtn" id="openbtn" value="Masukkan" onclick="insertAudioString()">\r\n            <input type="button" name="uploadbtn" id="openbtn" value="Unggah" onclick="uploadAudioCompress()">\r\n            <input type="button" name="closebtn" id="closebtn" value="Batal" onclick="closeDialogFile()">\r\n        </form>\r\n    </div>\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true"),$.get("ajax-load-compress-audio.php",{test_id:testID},function(e){$("#remote-image-list").html(e)}),initDragDropUpload()}function showDialogOpenFile(){let e='<div class="file-dialog">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeDialogFile();"><span></span></a><span id="file-dialog-title-label">Buka Soal Ujian</span></div>\r\n    <div id="file-dialog-list">\r\n    </div>\r\n    <div class="file-dialog-control">\r\n    <div class="file-dialog-form">\r\n    \t <form name="filefrm" id="filefrm" onsubmit="loadFile(); return false;">\r\n        \t <input type="text" name="filename" id="filename">\r\n            <input type="button" name="openbtn" id="openbtn" value="Buka" onclick="loadFile()">\r\n            <input type="button" name="closebtn" id="closebtn" value="Batal" onclick="closeDialogFile()">\r\n        </form>\r\n    </div>\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true")}function showDialogDeleteFile(){let e='<div class="file-dialog">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeDialogFile();"><span></span></a><span id="file-dialog-title-label">Hapus Soal Ujian</span></div>\r\n    <div id="file-dialog-list">\r\n    </div>\r\n    <div class="file-dialog-control">\r\n    <div class="file-dialog-form">\r\n    \t <form name="filefrm" id="filefrm" onsubmit="deleteFileFromStorage(); return false;">\r\n        \t <input type="text" name="filename" id="filename">\r\n            <input type="button" name="deletebtn" id="deletebtn" value="Hapus" onclick="deleteFileFromStorage()">\r\n            <input type="button" name="closebtn" id="closebtn" value="Tutup" onclick="closeDialogFile()">\r\n        </form>\r\n    </div>\r\n    </div>\r\n</div>\r\n',t=document.getElementById("dialog-area");t.innerHTML=e,t.setAttribute("data-dialog-shown","true")}function showDialogSaveFile(e){e=e||"";let t='<div class="file-dialog">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeDialogFile();"><span></span></a><span id="file-dialog-title-label">Simpan Soal Ujian</span></div>\r\n    <div id="file-dialog-list">\r\n    </div>\r\n    <div class="file-dialog-control">\r\n    <div class="file-dialog-form">\r\n    \t <form name="filefrm" id="filefrm" onsubmit="writeFile(); return false;">\r\n        \t <input type="text" name="filename" id="filename">\r\n            <input type="button" name="savebtn" id="savebtn" value="Simpan" onclick="writeFile()">\r\n            <input type="button" name="closebtn" id="closebtn" value="Batal" onclick="closeDialogFile()">\r\n        </form>\r\n    </div>\r\n    </div>\r\n</div>\r\n',i=document.getElementById("dialog-area");i.innerHTML=t,i.setAttribute("data-dialog-shown","true"),document.getElementById("filename").value=e}function showTestInfo(e){let t='<div class="file-dialog">\r\n\t<div class="file-dialog-title"><a class="file-dialog-close-icon" href="javascript:closeDialogFile();"><span></span></a><span id="file-dialog-title-label">Informasi Ujian</span></div>\r\n    <div id="file-dialog-list" style="height:300px;">\r\n    </div>\r\n</div>\r\n';$.get("ajax-load-test-info.php",{test_id:e},function(e){$("#file-dialog-list").append(e)});let i=document.getElementById("dialog-area");i.innerHTML=t,i.setAttribute("data-dialog-shown","true")}function newFile(){let e=document.getElementById("input").value;contentModified?pbDialog(""!=currentFileName?{modal:!0,width:360,height:190,title:"Konfirmasi",content:"<p>Apakah Anda akan menyimpan "+currentFileName+"?</p>",buttons:{Ya:function(){saveFileData(currentFileName,e),animateSaving(),contentModified=!1,currentFileName="",document.getElementById("input").value="",document.getElementById("preview2").innerHTML="",closeDialog()},Tidak:function(){contentModified=!1,currentFileName="",document.getElementById("input").value="",document.getElementById("preview2").innerHTML="",closeDialog()},Batal:function(){closeDialog()}}}:{modal:!0,width:360,height:190,title:"Konfirmasi",content:"<p>Apakah Anda akan menyimpan soal-soal ini?</p>",buttons:{Ya:function(){closeDialog(),saveFileAs()},Tidak:function(){closeDialog(),contentModified=!1,currentFileName="",document.getElementById("input").value="",document.getElementById("preview2").innerHTML=""},Batal:function(){closeDialog()}}}):(currentFileName="",document.getElementById("input").value="",document.getElementById("preview2").innerHTML="")}function restartQuestion(){let e=1;modContinue=!1,document.getElementById("toolbar-continue").classList.remove("toolbar-selected"),document.getElementById("toolbar-restart").classList.add("toolbar-selected"),document.getElementById("preview1").style.display="none",$("#preview2 > ol > li:first-child").attr("value",e);let t=document.getElementById("input"),i=document.getElementById("preview2"),n=document.getElementById("status");renderQuestion(t,i,n)}function continueQuestion(){let e=1;modContinue=!0,document.getElementById("toolbar-restart").classList.remove("toolbar-selected"),document.getElementById("toolbar-continue").classList.add("toolbar-selected"),$.get("ajax-load-stored-question.php",{test_id:testID,edit_mode:editMode?1:0},function(t){$("#preview1").html(t),$("#preview1").css({display:"block"}),$("#question-separator").css({display:"block"});let i=$("#preview1 > ol > li").length;e=i+1,$("#preview2 > ol > li:first-child").attr("value",e);let n=document.getElementById("input"),a=document.getElementById("preview2"),l=document.getElementById("status");renderQuestion(n,a,l)}),document.getElementById("preview1").style.display="block"}function appendToTest(){let e=document.getElementById("input").value,t=buildQuestion(e),i=noAnswer(t);if(i.length>0)pbDialog({modal:!0,width:360,height:140,title:"Soal Tidak Lengkap",content:"<p>Soal yang Anda buat tidak lengkap? Anda "+i.length+" soal yang tidak memiliki jawaban.</p>\r\n<p>Soal tanpa jawaban yaitu "+i.join(", ")+".</p>\r\n<p>Silakan perbaiki dahulu soal Anda.</p>\r\n",buttons:{Tutup:function(){closeDialog()}}});else{let e=1;pbDialog({modal:!0,width:360,height:140,title:"Memasukkan Soal",content:"<p>Apakah Anda akan memasukkan soal-soal ini ke dalam ujian?</p>",buttons:{Ya:function(){let t=document.getElementById("input").value;$.post("ajax-append-question.php",{question_text:t,test_id:testID,edit_mode:editMode?1:0,option:"add"},function(t){$("#preview1").html(t),$("#preview1").css({display:"block"}),$("#question-separator").css({display:"block"});let i=$("#preview1 > ol > li").length;e=i+1,$("#preview2 > ol > li:first-child").attr("value",e),document.getElementById("toolbar-restart").classList.remove("toolbar-selected"),document.getElementById("toolbar-continue").classList.add("toolbar-selected"),document.getElementById("preview1").style.display="block",document.getElementById("input").value="",document.getElementById("input").focus()}),closeDialog()},Tidak:function(){closeDialog()}}})}}function downloadFile(){let e=document.getElementById("input").value;e=e.replaceAll("\n","\r\n");let t=new Blob([e],{type:"text/plain"});saveAs(t,""!=currentFileName?currentFileName+".txt":"Soal-Ujian.txt","text/plain")}function downloadFileHTML(){let e='<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\r\n<style type="text/css">span.score{display:none;}</style>\r\n<title>Soal Ujian</title>\r\n</head>\r\n<body>\r\n'+document.getElementById("preview2").innerHTML+"\r\n</body>\r\n</html>";e=e.split('<span class="score"></span>').join("");let t=new Blob([e],{type:"text/html"});saveAs(t,""!=currentFileName?currentFileName+".html":"Soal-Ujian.html","text/html")}function downloadFileWord(){let e='<!DOCTYPE html>\r\n<html lang="en">\r\n<head>\r\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\r\n<style type="text/css">span.score{display:none;} .container{} .container p, .container li{line-height:1.6;}</style>\r\n<title>Soal Ujian</title>\r\n</head>\r\n<body>\r\n<div class="container">\r\n'+document.getElementById("preview2").innerHTML+"\r\n</div>\r\n</body>\r\n</html>";e=e.split('<span class="score"></span>').join("");let t=new Blob([e],{type:"application/vnd.doc"});saveAs(t,""!=currentFileName?currentFileName+".doc":"Soal-Ujian.doc","application/vnd.doc")}function toXML(e,t){return"<"+e+">"+t+"</"+e+">\r\n"}function downloadFileXML(){let e,t,i,n,a,l,o=buildQuestion(document.getElementById("input").value);for(e in l='<?xml version="1.0" encoding="utf-8"?>\r\n<test>\r\n',o){for(t in i=o[e],questionHTML=i.question,questionHTML=detectTable(questionHTML),n=question.options,l+="<item>\r\n",l+="<question><text>"+questionHTML.escapeHTMLEntities().escapeHTML()+"</text><random>1</random><numbering>"+question.numbering+"</numbering></question>\r\n",l+="<answer>\r\n",n)a=n[t],l+="<option><text>"+a.text.escapeHTMLEntities().escapeHTML()+"</text><value>"+a.score+"</value></option>";l+="</answer>\r\n",l+="</item>\r\n"}l+="</test>\r\n";let r=new Blob([l],{type:"text/xml"});saveAs(r,""!=currentFileName?currentFileName+".xml":"Soal-Ujian.xml","text/xml")}function uploadFile(){document.getElementById("file").click()}function toggleEditMode(){editMode=!editMode,editMode?$("#toolbar-edit").addClass("toolbar-selected"):$("#toolbar-edit").removeClass("toolbar-selected"),continueQuestion()}function printDiv(e,t){let i=frames.print_frame.document,n=i.createElement("style");n.appendChild(document.createTextNode('li{\r\nline-height:1.6;\r\n} \r\nli > span{\r\ndisplay:block;\r\n}\r\nol li table{\r\nborder-collapse:collapse;\r\nmargin-top:2px;\r\nmargin-bottom:2px;\r\n}\r\nol li table td{\r\npadding:3px 5px;\r\n}\r\nol li table td table{\r\nmargin-top:0;\r\nmargin-bottom:0;\r\n}\r\nol li table[border="1"]{\r\nborder-collapse:collapse;\r\n}\r\nol li table[border="1"] td{\r\npadding:4px 5px;\r\n}\r\nol li table[border="0"] td{\r\npadding:4px 0px;\r\n}\r\nol li table[border="1"] thead td{\r\nfont-weight:bold;\r\nbackground-color:#CCCCCC;\r\n}\r\nol li table[border="1"] tfoot td{\r\nbackground-color:#F8F8F8;\r\n}\r\n'));let a=document.getElementById(e).innerHTML;if(t){let e=$('<div id="preview">'+a+"<div>");e.find("#preview1 ol li ol li").each(function(e,t){let i=$(this);i.find(".score").length&&(i.css({"font-weight":"bold",color:"#06C"}),i.find("span").css({"font-weight":"normal",color:"#000000"}))}),e.find("#preview2 ol li ol li").each(function(e,t){let i=$(this);i.find(".score").length&&(i.css({"font-weight":"bold",color:"#06C"}),i.find("span").css({"font-weight":"normal",color:"#000000"}))}),a=e[0].outerHTML}window.frames.print_frame.document.body.innerHTML=a;let l=i.getElementsByTagName("body")[0];l.appendChild(n),window.frames.print_frame.window.focus(),window.frames.print_frame.window.print()}function printFile(e){e=e||!1;let t=document.createElement("iframe");t.setAttribute("id","print_frame"),t.setAttribute("name","print_frame"),t.setAttribute("width","0"),t.setAttribute("height","0"),t.setAttribute("frameborder","0"),t.setAttribute("src","about:blank"),t.style.position="absolute",t.style.top="-10000px",t.style.left="-10000px";let i=document.getElementsByTagName("body")[0];i.appendChild(t),printDiv("preview",e),t.remove()}function animateSaving(){let e=document.createElement("div");e.setAttribute("id","animation-saving"),document.getElementsByTagName("body")[0].appendChild(e),e.setAttribute("data-anim","false"),e.setAttribute("data-anim","true"),setTimeout(function(){e.remove()},400)}function copyExternalImage(e){$.ajax({
url:"tools/ajax/upload-file-multi.php?option=copyexternal&ujian_id="+testID,data:{url:e},type:"POST",dataType:"html",success:function(e){insertAtCursor(document.getElementById("input"),"img:"+e+" ")}})}function uploadBase64Image(e,t,i){t=t||"",$(".progressbar-fixed > div").css({width:"0%"}),$(".progressbar-fixed").css({display:"block"}),$.ajax({url:"ajax-upload-file-multi.php?option=uploadbase64image&test_id="+testID,data:{data:e,ext:i},type:"POST",dataType:"html",success:function(e){insertAtCursor(document.getElementById("input"),"img:"+e+t+" "),$(".progressbar-fixed").css({display:"none"})},xhr:function(){let e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",updateProgressFixed,!1),e}})}function uploadBase64ImageFromLatex(e,t,i,n){i=i||"png",console.log(i),$(".progressbar-fixed > div").css({width:"0%"}),$(".progressbar-fixed").css({display:"block"}),$.ajax({url:"ajax-upload-file-multi.php?option=uploadbase64image&test_id="+testID,data:{data:e,ext:i},type:"POST",dataType:"html",success:function(e){let t=" ";n&&(t="##"+encodeURIComponent(n)),insertAtCursor(document.getElementById("input"),"img:"+e+"#middle"+t+" ");let i=document.getElementById("input"),a=document.getElementById("preview2"),l=document.getElementById("status");renderQuestion(i,a,l),closeEquationDialog(),$(".progressbar-fixed").css({display:"none"})},xhr:function(){let e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",updateProgressFixed,!1),e}})}function handlePasteImage(e){if(e&&e.clipboardData&&e.clipboardData.getData)if(/Files/.test(e.clipboardData.types)&&!/text\/html/.test(e.clipboardData.types)){let t=e.clipboardData.items[0].getAsFile(),i=new window.FileReader;i.readAsDataURL(t),i.onloadend=function(){uploadBase64Image(i.result,"#text-top")},e.preventDefault&&(e.stopPropagation(),e.preventDefault())}else if(/Files/.test(e.clipboardData.types)&&/text\/html/.test(e.clipboardData.types)){let t=e.clipboardData.getData("text/html"),i=document.createElement("div");i.innerHTML=t;let n=0;for(let e in i.childNodes){if("IMG"==i.childNodes.item(e).tagName||"img"==i.childNodes.item(e).tagName){let t=i.childNodes.item(e).getAttribute("src");copyExternalImage(t)}n++}n>0&&e.preventDefault&&(e.stopPropagation(),e.preventDefault())}else if(/text\/html/.test(e.clipboardData.types)){let t=e.clipboardData.getData("text/html");try{e.clipboardData.setData("text/plain",t)}catch(e){}e.preventDefault}else/text\/plain/.test(e.clipboardData.types)}function updateProgress(e){if(e.lengthComputable){let t=e.loaded/e.total;$(".progressbar-inner").css({width:100*t+"%"})}}function updateProgressFixed(e){if(e.lengthComputable){let t=e.loaded/e.total;$(".progressbar-fixed-inner").css({width:100*t+"%"})}}function pbDialog(e){let t;e=e||{};let i={content:"",width:300,height:120,modal:!1,title:"Dialog",buttons:{OK:function(){},Cancel:function(){}}};for(let t in i)i.hasOwnProperty(t)&&void 0===e[t]&&(e[t]=i[t]);for(t in this.container=document.createElement("div"),this.container.classList.add("pb-dialog-container"),this.dialog=document.createElement("div"),this.dialog.classList.add("pb-dialog"),this.title=document.createElement("div"),this.title.classList.add("pb-dialog-title"),this.title.innerHTML="<h3>"+e.title+"</h3>",this.content=document.createElement("div"),this.content.classList.add("pb-dialog-content"),this.content.innerHTML=e.content,this.buttons=document.createElement("div"),this.buttons.classList.add("pb-dialog-buttons"),e.buttons){let i=document.createElement("button");i.innerHTML=t,i.addEventListener("click",e.buttons[t]),this.buttons.appendChild(i),this.buttons.appendChild(document.createTextNode(" "))}e.modal&&(this.cover=document.createElement("div"),this.cover.classList.add("pb-dialog-cover"),this.container.appendChild(this.cover)),this.container.appendChild(this.dialog),this.dialog.appendChild(this.title),this.dialog.appendChild(this.content),this.dialog.appendChild(this.buttons),document.getElementsByTagName("body")[0].appendChild(this.container)}function closeDialog(){document.getElementsByClassName("pb-dialog-container")[0].remove()}function insertAtCursor(e,t){if(document.selection){e.focus();let i=document.selection.createRange();i.text=t}else if(e.selectionStart||"0"==e.selectionStart){let i=e.selectionStart,n=e.selectionEnd;e.value=e.value.substring(0,i)+t+e.value.substring(n,e.value.length),e.setSelectionRange(i+t.length,i+t.length),e.focus()}else e.value+=t,e.focus()}function refreshList(e){$.get("ajax-load-image.php",{test_id:e},function(e){$("#remote-image-list").html(e)})}function initDragDropUpload(){if(window.File&&window.FileList&&window.FileReader){let e=$("#remote-image-list")[0];xhr.upload&&(e.addEventListener("dragenter",FileDragHover,!1),e.addEventListener("dragexit",FileDragHover,!1),e.addEventListener("dragover",FileDragHover,!1),e.addEventListener("dragleave",FileDragHover,!1),e.addEventListener("drop",FileSelectHandler,!1),e.style.display="block")}}function progressHandler(e){let t=e.loaded/e.total*100;$(".progressbar-inner").css({width:t+"%"})}function completeHandler(e){let t=e.target.responseText;$(".progressbar-inner").css({width:"0%"}),""!=t&&$(".progressbar").css({display:"none"})}function errorHandler(e){alert("Terjadi kesalahan.")}function abortHandler(e){alert("Proses dibatalkan")}function FileDragHover(e){e.stopPropagation(),e.preventDefault(),"dragover"==e.type?$("#remote-image-list").addClass("file-area-hover"):$("#remote-image-list").removeClass("file-area-hover")}function FileSelectHandler(e){FileDragHover(e);let t,i=testID;if(t=void 0!==e.dataTransfer&&e.dataTransfer.getData("Text")||"",t.indexOf("://")>-1)$.post("ajax-upload-file-multi.php?option=transfer&test_id="+i,{url:t},function(e){refreshList(i)});else{let t=e.target.files||e.dataTransfer.files,i=new FormData;for(let e=0;e<t.length&&!(e>=maxUploadFile-1);e++)i.append("images[]",t[e]);$(".progressbar").css({display:"block"}),xhr.open("POST","ajax-upload-file-multi.php?test_id="+testID),xhr.onload=function(){200===xhr.status&&($("#remote-image-list").html(xhr.responseText),$(".progressbar").css({display:"none"}))},xhr.upload.addEventListener("progress",progressHandler,!1),xhr.addEventListener("load",completeHandler,!1),xhr.addEventListener("error",errorHandler,!1),xhr.addEventListener("abort",abortHandler,!1),xhr.send(i)}}"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),String.prototype.replaceAll=function(e,t,i){return this.replace(new RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),i?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)},String.prototype.trimMask=function(e){let t=this.trim();for(;~e.indexOf(t[0]);)t=t.slice(1);for(;~e.indexOf(t[t.length-1]);)t=t.slice(0,-1);return t=t.trim(),t=t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),t},String.prototype.countSubstring=function(e){let t=this.split(e);return t.length-1},String.prototype.escapeHTML=function(e){return void 0===e?this.replace(/<br \/>/g,"\n").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/\n/g,"<br />"):this.replace(/<br \/>/g,"\n").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/\n/g,"&lt;br /&gt;")},String.prototype.restoreBR=function(){return this.replace(/&lt;br \/&gt;/g," <br />")},String.prototype.escapeHTMLEntities=function(){return escapeHtmlEntities(this)},String.prototype.restoreTableEntity=function(){return this.replaceAll("&lt;table border=&quot;1&quot;&gt;",'<table border="1">').replaceAll('&lt;table border="1"&gt;','<table border="1">').replaceAll("&lt;table&gt;","<table>").replaceAll("&lt;/table&gt;","</table>").replaceAll("&lt;thead&gt;","<thead>").replaceAll("&lt;/thead&gt;","</thead>").replaceAll("&lt;tbody&gt;","<tbody>").replaceAll("&lt;/tbody&gt;","</tbody>").replaceAll("&lt;tr&gt;","<tr>").replaceAll("&lt;/tr&gt;","</tr>").replaceAll("&lt;td&gt;","<td>").replaceAll("&lt;/td&gt;","</td>")},"undefined"==typeof escapeHtmlEntities&&(escapeHtmlEntities=function(e){return e.replace(/[\u00A0-\u2666<>\&]/g,function(e){return"&"+(escapeHtmlEntities.entityTable[e.charCodeAt(0)]||"#"+e.charCodeAt(0))+";"})},escapeHtmlEntities.entityTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"}),String.prototype.splitWithLimit=function(e,t){let i,n,a,l=this;l=l.toString();let o=[];if(!t)return l.split(e);i=e instanceof RegExp?new RegExp(e.source,"g"+(e.ignoreCase?"i":"")+(e.multiline?"m":"")):new RegExp(e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1"),"g");do{n=i.lastIndex,a=i.exec(l),a&&o.push(l.length<a.index-n?l:l.substring(n,a.index-n))}while(a&&o.length<t-1);return o.push(l.substring(i.lastIndex)),o};let numberingList={"upper-alpha":["A","B","C","D","E","F","G","H","I","J"],"lower-alpha":["a","b","c","d","e","f","g","h","i","j"],"upper-roman":["I","II","III","IV","V","VI","VII","VIII","IX","X"],"lower-roman":["i","ii","iii","iv","v","vi","vii","vii","ix","x"],decimal:["1","2","3","4","5","6","7","8","9","10"],"decimal-leading-zero":["01","02","03","04","05","06","07","08","09","10"]},verticalAlign=["baseline","top","bottom","middle","text-top","text-bottom"];String.prototype.addImage=function(e,t){let i=this;if(t=t||"",!e)return this;{let e,n,a,l,o,r,s,d,c,u,p,m=i.match(/(?:^|)img:([a-zA-Z\S]+)/gi);for(e in m)s=m[e].trimMask(" \r\n\t "),u=s.indexOf("img:"),d=s.substr(u+4),a="",d.indexOf("#")>-1&&(n=d.split("#"),d=n[0],$.inArray(n[1],verticalAlign)>-1&&(a+=' style="vertical-align:'+n[1]+'"'),n.length>2&&(l=n[2].split(","),o=parseInt(l[0]||"0"),r=parseInt(l[1]||"0"),o>0&&(a+=' width="'+o+'"'),r>0&&(a+=' height="'+r+'"'))),p=-1!=d.indexOf("://")?"":t,c='<img src="'+p+d+'"'+a+">",i=i.replace(s,c);for(e in m=i.match(/(?:^|)audio:([a-zA-Z\S]+)/gi),m)s=m[e].trimMask(" \r\n\t "),u=s.indexOf("audio:"),d=s.substr(u+6),a="",d.indexOf("#")>-1?(n=d.split("#"),d=n[0],$.inArray(n[1],verticalAlign)>-1&&(a+=' style="vertical-align:'+n[1]+'"'),n.length>2?(l=n[2].split(","),o=parseInt(l[0]||"0"),r=parseInt(l[1]||"0"),a+=o>0?' width="'+o+'"':' width="300"',a+=r>0?' height="'+r+'"':' height="50"'):a+=' width="300" height="50"'):a+=' width="300" height="40"',p=-1!=d.indexOf("://")?"":t,p=-1!=d.indexOf("://")?"":t,c='<audio src="'+p+d+'"'+a+" controls></audio>",i=i.replace(s,c);for(e in m=i.match(/(?:^|)video:([a-zA-Z\S]+)/gi),m)s=m[e].trimMask(" \r\n\t "),u=s.indexOf("video:"),d=s.substr(u+6),a="",d.indexOf("#")>-1?(n=d.split("#"),d=n[0],$.inArray(n[1],verticalAlign)>-1&&(a+=' style="vertical-align:'+n[1]+'"'),n.length>2?(l=n[2].split(","),o=parseInt(l[0]||"0"),r=parseInt(l[1]||"0"),a+=o>0?' width="'+o+'"':' width="500"',a+=r>0?' height="'+r+'"':' height="280"'):a+=' width="500" height="280"'):a+=' width="500" height="280"',p=-1!=d.indexOf("://")?"":t,p=-1!=d.indexOf("://")?"":t,c='<video src="'+p+d+'"'+a+" controls></video>",i=i.replace(s,c);for(e in m=i.match(/(?:^|)iframe:([a-zA-Z\S]+)/gi),m)s=m[e].trimMask(" \r\n\t "),u=s.indexOf("iframe:"),d=s.substr(u+7),a="",d.indexOf("#")>-1?(n=d.split("#"),d=n[0],$.inArray(n[1],verticalAlign)>-1&&(a+=' style="vertical-align:'+n[1]+'"'),n.length>2?(l=n[2].split(","),o=parseInt(l[0]||"0"),r=parseInt(l[1]||"0"),a+=o>0?' width="'+o+'"':' width="500"',a+=r>0?' height="'+r+'"':' height="280"'):a+=' width="500" height="280"'):a+=' width="500" height="280"',p=-1!=d.indexOf("://")?"":t,p=-1!=d.indexOf("://")?"":t,c='<iframe src="'+p+d+'"'+a+' allowfullscreen="allowfullscreen" frameborder="0"></iframe>',i=i.replace(s,c);for(e in m=i.match(/(?:^|)youtube:([a-zA-Z\S]+)/gi),m){s=m[e].trimMask(" \r\n\t "),u=s.indexOf("img:"),d=s.substr(u+4),a="",d.indexOf("#")>-1&&(n=d.split("#"),d=n[0],$.inArray(n[1],verticalAlign)>-1&&(a+=' style="vertical-align:'+n[1]+'"')),p=-1!=d.indexOf("://")?"":t;let l=a,o=getYouTubeParams(d),r=0,g=o.video_id;c='<iframe type="text/html" marginwidth="0" marginheight="0" scrolling="no" src="https://www.youtube.com/embed/'+g+"?html5=1&playsinline=1&allowfullscreen=true&rel=0&version=3&autoplay=0&start="+r+'" allowfullscreen="" height="281" width="500"'+l+' frameborder="0"></iframe>',i=i.replace(s,c)}m=i.split("$$");let g="";for(e=1;e<m.length;e+=2)s=m[e],g=s.trimMask(" \r\n\t "),g.length?(c='<img src="../cgi-bin/equgen.cgi?'+s+'" style="vertical-align:middle" data-latex="'+s+'" alt="'+s+'">',i=i.replace("$$"+s+"$$",c)):i=i.replace("$$"+s+"$$","")}return i};let contentModified=!1,currentFileName="",fileNameList=[],modContinue=!1,editMode=!1,xhr;if(window.XMLHttpRequest)xhr=new XMLHttpRequest;else{let e=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];for(let t=0,i=e.length;t<i;t++)try{xhr=new ActiveObject(e[t]);break}catch(e){}}window.onload=function(){document.getElementById("input").addEventListener("change",function(e){inputChanged(e),contentModified=!0}),document.getElementById("input").addEventListener("keyup",function(e){let t;void 0!==document.createEvent?(t=document.createEvent("KeyboardEvent"),t.initEvent("change",!0,!0)):t=new Event("change"),e.target.dispatchEvent(t)}),document.getElementById("input").addEventListener("focus",function(e){let t;void 0!==document.createEvent?(t=document.createEvent("KeyboardEvent"),t.initEvent("change",!0,!0)):t=new Event("change"),e.target.dispatchEvent(t)}),document.getElementById("input").addEventListener("keydown",function(e){83==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),""!=currentFileName?(saveFileData(currentFileName,e.target.value),animateSaving()):saveFileAs()),(69==e.keyCode||81==e.keyCode)&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(showLatexDialog(),e.preventDefault(),e.stopPropagation()),87==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),e.stopPropagation())}),document.getElementById("input").addEventListener("keypress",function(e){((13==e.keyCode||10==e.keyCode)&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)||(13==e.keyCode||10==e.keyCode)&&(navigator.platform.match("Mac")?e.metaKey:e.shiftKey))&&(insertAtCursor(e.target,"\\\\\n"),e.preventDefault(),e.stopPropagation())}),document.getElementById("input").addEventListener("paste",function(e){let t;handlePasteImage(e),setTimeout(function(){void 0!==document.createEvent?(t=document.createEvent("KeyboardEvent"),t.initEvent("change",!0,!0)):t=new Event("change"),e.target.dispatchEvent(t)},500)}),document.getElementById("input").focus(),document.getElementById("file").onchange=function(){let e=this.files[0],t=new FileReader;t.onload=function(e){let t=this.result;document.getElementById("input").value=t,document.getElementById("input").focus()},t.readAsText(e)},document.getElementById("audio").onchange=function(){let e=testID,t=this.files[0],i=new FormData;i.append("audios[]",t),$(".progressbar > div").css({width:"0%"}),$(".progressbar").css({display:"block"}),$.ajax({url:"ajax-upload-audio-multi.php?test_id="+e,type:"POST",processData:!1,data:i,dataType:"text",contentType:!1,success:function(e){$("#remote-image-list").empty().append(e),$(".progressbar").css({display:"none"})},xhr:function(){let e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",updateProgress,!1),e}})},document.getElementById("audio2").onchange=function(){let e=testID,t=this.files[0],i=new FormData;i.append("audios[]",t),$(".progressbar > div").css({width:"0%"}),$(".progressbar").css({display:"block"}),$.ajax({url:"ajax-upload-audio-multi.php?option=compress&test_id="+e,type:"POST",processData:!1,data:i,dataType:"text",contentType:!1,success:function(e){$("#remote-image-list").empty().append(e),$(".progressbar").css({display:"none"})},xhr:function(){let e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",updateProgress,!1),e}})},$(document).on("change","#image",function(e){FileSelectHandler(e)}),$(document).on("click","#remote-image-list .img-li a, #remote-image-list .select-audio a",function(e){let t=$(this).attr("data-name");$("#filename").val(t),e.preventDefault()}),$(document).on("change","#file",function(e){}),$(document).on("click",".compress-audio-file",function(e){let t=$(this).attr("data-name"),i=$(this).closest("tr"),n=i.find("td:first-child").text().toString().trim(),a=testID,l=$(this);pbDialog({modal:!0,width:360,height:190,title:"Konfirmasi",content:"<p>Mengompres file akan memperkecil ukuran file dan menurunkan kualitas suara. Pastikan bahwa Anda tidak mengompres file yang sama lebih dari satu kali.<br />Apakah Anda akan mengompres file "+t+"?</p>",buttons:{Ya:function(){l.replaceWith('<span class="animation-pressure"><span></span></span>'),$.post("ajax-compress-audio-file.php",{filename:t,no:n,test_id:a},function(e){i.replaceWith(e)}),closeDialog()},Tidak:function(){closeDialog()}}})}),$(document).on("click","#toolbar-info",function(e){let t=$(this).attr("data-test-id");showTestInfo(t)}),contentModified=!1};