function basename(path){return path.replace(/\\/g,"/").replace(/.*\//,"")}function dirname(path){return path.replace(/\\/g,"/").replace(/\/[^\/]*$/,"")}function getfileextension(filename){return/[.]/.exec(filename)?/[^.]+$/.exec(filename):""}function removefileextension(filename){return filename.replace(/\.[^/.]+$/,"")}function fileBrowserCallBack(field_name,url,type,win){-1!=url.indexOf("data:")&&(url=""),url=url.substr(baseTestURLLength);var ajaxfilemanagerurl="lib.tools/filemanager/?test_id="+test_id+"&editor=tiny_mce&type="+type+"&field_name="+field_name+"&dir=base/"+dirname(url);switch(type){case"image":case"media":case"flash":case"file":break;default:return!1}tinyMCE.activeEditor.windowManager.open({url:ajaxfilemanagerurl,width:780,height:440,resizable:!0,maximizable:!0,inline:"yes",close_previous:"no"},{window:win,input:field_name})}var ascii_svg_server="lib.tools/asciisvg/svgimg.php",equation_preview_url="../../../../../../cgi-bin/equgen.cgi?",equation_generator_url="../../../../../../equgen.php?",equation_renderer_machine=navigator.userAgent.toString().indexOf("Firefox")>-1?"browser-png":"server-png",quran_server="../quran";function pasteHandler(e){var cbData;if(e.clipboardData?cbData=e.clipboardData:window.clipboardData&&(cbData=window.clipboardData),e.msConvertURL){var fileList=cbData.files;if(fileList.length>0)for(var i=0;i<fileList.length;i++){var blob;readPastedBlob(blob=fileList[i])}}if(cbData&&cbData.items){if(text=cbData.getData("text/plain"))return;for(var i=0;i<cbData.items.length;i++){var blob;if(-1!==cbData.items[i].type.indexOf("image"))readPastedBlob(blob=cbData.items[i].getAsFile())}}function readPastedBlob(blob){blob&&(reader=new FileReader,reader.onload=function(evt){pasteImage(evt.target.result)},reader.readAsDataURL(blob))}function pasteImage(source){if(-1==window.navigator.userAgent.toString().indexOf("Firefox")){var image="<img src='"+source+"' data-mce-selected='1'></img>";window.tinyMCE.execCommand("mceInsertContent",!1,image)}}}function simpansoal(frm){var emptyeditor=0;if($(".htmleditor").each((function(index){var val;""==$(this).html()&&emptyeditor++})),emptyeditor>0)return alert("Soal dan option tidak boleh kosong."+emptyeditor),!1;var val_total=0,val_over=0;if($(".score").each((function(index){var val=parseInt($(this).val());""==$(this).val()&&(val=0),val>maxScore&&val_over++,val_total+=val})),val_over>0)return alert("Nilai maksimum untuk setiap answer adalah "+maxScore),!1;if(0==val_total)return alert("Minimal ada sebuah pilihan yang mempunyai nilai."),!1;var args,data="save=save&"+$(frm).serialize();return $.ajax({url:"ajax-add-question.php",data:{data:data},type:"POST",dataType:"json",success:function(obj){0==obj.duplicated||"0"==obj.duplicated?($(".htmleditor").each((function(index){$(this).tinymce().execCommand("mceSetContent",!1,"")})),$(".score").val(""),$("#total_collection").text(obj.collection),$(document).scrollTop(0)):($("#total_collection").text(obj.collection),alert("Soal yang sama untuk ujian ini telah dibuat sebelumnya. Silakan ubah soal dan jawaban."),$(document).scrollTop(0))}}),!1}$(document).ready((function(){$("textarea.htmleditor").tinymce({script_url:"../lib.assets/script/tiny_mce/tiny_mce.js",theme:"advanced",ascii_svg_server:ascii_svg_server,equation_preview_url:equation_preview_url,equation_generator_url:equation_generator_url,equation_renderer_machine:equation_renderer_machine,quran_server:quran_server,plugins:"autolink,lists,style,table,advhr,advimage,advlink,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,advlist,quran,latex,equation,chem,asciisvg,chart",theme_advanced_buttons1:"pasteword,pastetext,undo,redo,search,bold,italic,underline,strikethrough,formatselect,fontselect,fontsizeselect,justifyleft,justifycenter,justifyright,justifyfull,ltr,rtl,numlist,bullist,indent,outdent,blockquote",theme_advanced_buttons2:"visualaid,forecolor,backcolor,removeformat,anchor,link,unlink,image,media,quran,charmap,sup,sub,latex,equation,chem,asciisvg,chart,hr,table,row_props,cell_props,col_after,col_before,row_after,row_before,merge_cells,split_cells,delete_col,delete_row,delete_table,quran,arabiceditor,code,preview",theme_advanced_buttons3:"",theme_advanced_buttons4:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:!0,theme_advanced_resize_horizontal:!1,extended_valid_elements:"iframe[style|src|title|width|height|allowfullscreen|frameborder]",content_css:"../lib.assets/theme/default/css/content-test-editor.css",file_browser_callback:"fileBrowserCallBack",apply_source_formatting:!0,accessibility_warnings:!1,template_replace_values:{username:"Kamshory",staffid:"612126"}}),setTimeout((function(){$("textarea.htmleditor").each((function(index,element){var id=$(this).attr("id"),iframe=document.getElementById(id+"_ifr"),innerDoc=iframe.contentDocument||iframe.contentWindow.document}))}),2e3),$(document).on("change","#numbering",(function(){var val=$(this).val();$(".option-item").each((function(index,element){var idx=parseInt($(this).attr("data-index")),label=numbering[val][idx];$(this).find(".option-label").text(label)}))}))}));