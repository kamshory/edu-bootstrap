function setInputSelection(e,t,i){if(e.focus(),void 0!==e.selectionStart)e.selectionStart=t,e.selectionEnd=i;else if(document.selection&&document.selection.createRange){e.select();let a=document.selection.createRange();a.collapse(!0),a.moveEnd("character",i),a.moveStart("character",t),a.select()}}function initPreviewImageUpload(){$(document).on("click","#image-list li img",function(){let e="../../../"+$(this).attr("src");show=!0,width=parseFloat($(this).width()),height=parseFloat($(this).height());let t=6*width,i=6*height;startX=parseFloat($(this).offset().left),startY=parseFloat($(this).offset().top),centerX=parseFloat($(window).width())/2,centerY=parseFloat($(window).height())/2,endX=centerX-t/2-5,endY=centerY-i/2-5,$(".preview-image").remove(),show=!0,$("<img/>").attr("src",e).addClass("preview-image").css({width:width+"px",height:height+"px",position:"absolute","z-index":"5000",left:startX+"px",top:startY+"px",border:"1px solid #CCCCCC","border-radius":"1px",padding:"4px","background-color":"#FFFFFF","box-shadow":"0 0 2px #CCCCCC"}).appendTo("body"),$(".preview-image").animate({width:t,height:i,left:endX,top:endY},200),$(".preview-image, .ui-dialog, .ui-widget-overlay").click(function(){show=!1,$(".preview-image").animate({width:width,height:height,left:startX,top:startY},200,function(){show||$(".preview-image").remove()})})})}function updateToolbarStatus(){$(".fileid:checked").length==$(".fileid").length?$(".toolbar-inner li a img.check").parent().parent().addClass("inactive"):$(".toolbar-inner li a img.check").parent().parent().removeClass("inactive"),""==clipboardfile.operation?$(".toolbar-inner li a img.paste").parent().parent().addClass("inactive"):$(".toolbar-inner li a img.paste").parent().parent().removeClass("inactive"),0==$(".fileid:checked").length?($(".toolbar-inner li a img.uncheck").parent().parent().addClass("inactive"),$(".toolbar-inner li a img.copy").parent().parent().addClass("inactive"),$(".toolbar-inner li a img.cut").parent().parent().addClass("inactive"),$(".toolbar-inner li a img.move").parent().parent().addClass("inactive"),$(".toolbar-inner li a img.delete").parent().parent().addClass("inactive"),$(".toolbar-inner li a img.rename").parent().parent().addClass("inactive"),$(".toolbar-inner li a img.compress").parent().parent().addClass("inactive"),$(".toolbar-inner li a img.permission").parent().parent().addClass("inactive")):($(".toolbar-inner li a img.uncheck").parent().parent().removeClass("inactive"),$(".toolbar-inner li a img.copy").parent().parent().removeClass("inactive"),$(".toolbar-inner li a img.cut").parent().parent().removeClass("inactive"),$(".toolbar-inner li a img.move").parent().parent().removeClass("inactive"),$(".toolbar-inner li a img.delete").parent().parent().removeClass("inactive"),$(".toolbar-inner li a img.rename").parent().parent().removeClass("inactive"),$(".toolbar-inner li a img.compress").parent().parent().removeClass("inactive"),$(".toolbar-inner li a img.permission").parent().parent().removeClass("inactive")),$('.row-data-file[data-file-type="application/zip"]').find("input[type=checkbox]:checked").length?$(".toolbar-inner li a img.extract").parent().parent().removeClass("inactive"):$(".toolbar-inner li a img.extract").parent().parent().addClass("inactive"),$(document).on("click",".toolbar-inner li.inactive a",function(){return!1})}function addslashes(e){let t="'",i="\\'",a=new RegExp(t,"g"),l=e.replace(a,i);return l}function basename(e){return e.replace(/\\/g,"/").replace(/.*\//,"")}function dirname(e){return e.replace(/\\/g,"/").replace(/\/[^\/]*$/,"")}function getfileExtension(e){return e.slice(2+(e.lastIndexOf(".")-1>>>0))}function removefileextension(e){return e.replace(/\.[^/.]+$/,"")}function setCheckRelation(){$(document).on("change",".checkbox-selector",function(){let e,t=$(this)[0].checked,i=$(this).attr("data-target"),a=$(i).length;if(t)for(e=0;e<a;e++)$(i)[e].checked=!0;else for(e=0;e<a;e++)$(i)[e].checked=!1;updateToolbarStatus()})}function jqAlert(e,t,i,a){$("#mb-area").remove(),$("body").append('<div id="mb-area" style="display:none;"><div id="message-box-dialog"><div id="message-box-dialog-inner"></div></div></div>'),t||(t="Alert"),i||(i=300),a||(a=165);try{$("#message-box-dialog").dialog("destroy")}catch(e){}$("#message-box-dialog-inner").html(e),$("#message-box-dialog").dialog({width:i,height:a,modal:!0,title:t,buttons:{Close:function(){try{$("#message-box-dialog").dialog("destroy")}catch(e){}}}})}function contextMenu(e,t){$(e).on("contextmenu",function(i){i.preventDefault();let a,l=parseInt(i.clientX),o=i.clientY,n=$(document).scrollLeft(),r=$(document).scrollTop();l=parseInt(l)+parseInt(n),o=parseInt(o)+parseInt(r);let s=parseInt($(window).width()),d=parseInt($(window).height());$(".kams-context-menu").remove(),a='<div class="kams-context-menu"></div>',$("body").append(a),a="<ul>";for(let i in t){let l=t[i].classname;if(!$(e).hasClass("row-data-file")&&!$(e).hasClass("row-data-dir")){if(""==clipboardfile.operation&&("empty-clipboard"==l||"paste"==l))continue;if(("copy"==l||"cut"==l||"move"==l||"delete"==l||"compress"==l||"permission"==l||"uncheck"==l)&&0==$(".fileid:checked").length)continue;if($(".fileid:checked").length==$(".fileid").length&&"check"==l)continue}a+='<li class="file-function file-function-'+l+'"><a href="'+t[i].linkurl+'">'+t[i].caption+"</a></li>"}a+="</ul>",$(".kams-context-menu").html(a),$(".kams-context-menu").css({display:"none",left:l+"px",top:o+"px"});let c=parseInt($(".kams-context-menu").width()),p=parseInt($(".kams-context-menu").height());return c+l+16>=s&&(l-=c,$(".kams-context-menu").css({left:l+"px",top:o+"px"})),p+o+20>=d&&(o=d-parseInt(p)-20,$(".kams-context-menu").css({left:l+"px",top:o+"px"})),$(".kams-context-menu").fadeIn(300),$(document).on("click",function(){$(".kams-context-menu").fadeOut(150,function(){})}),$(document).on("keydown",function(e){e.keyCode&&e.keyCode===$.ui.keyCode.ESCAPE&&$(".kams-context-menu").fadeOut(150,function(){})}),!1})}function setSize(){let e=parseInt($(window).height()),t=parseInt($(window).width()),i=parseInt($(".directory-area").outerWidth())+20;$(".directory-area, .file-area").css("height",e-84+"px"),$(".file-area").css({width:t-i+"px","margin-left":i-14+"px"})}function initContextMenuFileArea(){let e=[{caption:"Copy Selected File",linkurl:"javascript:copySelectedFile()",classname:"copy"},{caption:"Cut Selected File",linkurl:"javascript:cutSelectedFile()",classname:"cut"},{caption:"Move Selected File",linkurl:"javascript:moveSelectedFile()",classname:"move"},{caption:"Delete Selected File",linkurl:"javascript:deleteSelectedFile()",classname:"delete"},{caption:"Compress Selected File",linkurl:"javascript:compressSelectedFile()",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission()",classname:"permission"},{caption:"Paste File",linkurl:"javascript:pasteFile()",classname:"paste"},{caption:"Create New File",linkurl:"javascript:createFile()",classname:"createfile"},{caption:"Create New Directory",linkurl:"javascript:createDirectory()",classname:"createdir"},{caption:"Up Directory",linkurl:"javascript:goToUpDir()",classname:"up"},{caption:"Refresh File List",linkurl:"javascript:refreshList()",classname:"refresh"},{caption:"Change View Type",linkurl:"javascript:thumbnail()",classname:"view"},{caption:"Upload File",linkurl:"javascript:uploadFile()",classname:"upload"},{caption:"Check All",linkurl:"javascript:selectAll(1)",classname:"check"},{caption:"Uncheck All",linkurl:"javascript:selectAll(0)",classname:"uncheck"},{caption:"Empty Clipboard",linkurl:"javascript:emptyClipboard()",classname:"empty-clipboard"}];contextMenu(".file-area",e)}function initContextMenuFile(){$(".row-data-file").each(function(e){let t=$(this).attr("data-file-type"),i=$(this).attr("data-file-name"),a=$(this).attr("data-file-location"),l=a+"/"+i,o=$(this).attr("data-file-url");if(-1!=t.indexOf("image")||-1!=t.indexOf("shockwave")){let e=$(this).attr("data-image-width"),i=$(this).attr("data-image-height"),a={width:e,height:i};contextMenu(this,contextMenuListFile(t,l,o,a))}else contextMenu(this,contextMenuListFile(t,l,o))})}function initContextMenuDir(){$(".row-data-dir").each(function(e){let t=$(this).attr("data-file-name"),i=$(this).attr("data-file-location"),a=i+"/"+t;contextMenu(this,contextMenuListDir(a))})}function previewSVG(e){let t="../../"+e;playVideo(t,"iframe")}function contextMenuListFile(e,t,i,a){t=addslashes(t),i=addslashes(i);let l,o="0",n="0";return 0==e.indexOf("image")?(o=parseInt(a.width),n=parseInt(a.height),l=[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Preview Image",linkurl:"javascript:previewFile('"+i+"', "+o+", "+n+", false, true)",classname:"preview"},{caption:"Edit Image",linkurl:"javascript:editImage('"+t+"')",classname:"edit-image"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"Image Properties",linkurl:"javascript:propertyImage('"+t+"')",classname:"property"}]):0==e.indexOf("video")?l=[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Play Video",linkurl:"javascript:playVideo('"+i+"', 'html5')",classname:"play"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"Video Properties",linkurl:"javascript:propertyVideo('"+t+"')",classname:"property"}]:0==e.indexOf("audio")?l=[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Play Audio",linkurl:"javascript:playAudio('"+i+"', 'html5')",classname:"play"},{caption:"Compress Audio",linkurl:"javascript:compressAudio('"+t+"')",classname:"play"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"File Properties",linkurl:"javascript:propertyFile('"+t+"')",classname:"property"}]:-1!=e.indexOf("pdf")?l=[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Read PDF Document",linkurl:"javascript:previewPDF('"+i+"')",classname:"preview"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"File Properties",linkurl:"javascript:propertyFile('"+t+"')",classname:"property"}]:-1!=e.indexOf("svg")?l=[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Preview SVG",linkurl:"javascript:previewSVG('"+i+"')",classname:"preview"},{caption:"Edit as Text",linkurl:"javascript:editFile('"+t+"')",classname:"edit"},{caption:"Edit Code",linkurl:"code-editor.php?filepath="+encodeURIComponent(t)+'" target="_blank',classname:"edit"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"File Properties",linkurl:"javascript:propertyFile('"+t+"')",classname:"property"}]:-1!=e.indexOf("shockwave")?(o=parseInt(a.width),n=parseInt(a.height),l=[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"View Shock Wave",linkurl:"javascript:previewSWF('"+i+"', "+o+", "+n+")",classname:"preview"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"File Properties",linkurl:"javascript:propertyFile('"+t+"')",classname:"property"}]):l=0==e.indexOf("application/zip")?[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Extract File",linkurl:"javascript:extractFile('"+t+"')",classname:"extract"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"File Properties",linkurl:"javascript:propertyFile('"+t+"')",classname:"property"}]:0==e.indexOf("text")||-1!=e.indexOf("php")?[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Edit as Text",linkurl:"javascript:editFile('"+t+"')",classname:"edit"},{caption:"Edit Code",linkurl:"code-editor.php?filepath="+encodeURIComponent(t)+'" target="_blank',classname:"edit"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"File Properties",linkurl:"javascript:propertyFile('"+t+"')",classname:"property"}]:[{caption:"Select File",linkurl:"javascript:selectFile('"+i+"')",classname:"select"},{caption:"Copy File",linkurl:"javascript:copyFile('"+t+"')",classname:"copy"},{caption:"Cut File",linkurl:"javascript:cutFile('"+t+"')",classname:"cut"},{caption:"Rename File",linkurl:"javascript:renameFile('"+t+"')",classname:"rename"},{caption:"Move File",linkurl:"javascript:moveFile('"+t+"')",classname:"move"},{caption:"Delete File",linkurl:"javascript:deleteFile('"+t+"')",classname:"delete"},{caption:"Compress File",linkurl:"javascript:compressFile('"+t+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+t+"')",classname:"permission"},{caption:"Download File",linkurl:"../../../"+i+'" target="_blank',classname:"download"},{caption:"Force Download File",linkurl:"javascript:forceDownloadFile('"+t+"')",classname:"download"},{caption:"File Properties",linkurl:"javascript:propertyFile('"+t+"')",classname:"property"}],l}function contextMenuListDir(e){let t;return e=addslashes(e),t=[{caption:"Open Directory",linkurl:'javascript:;" onClick="return openDir(\''+e+"')",classname:"open"},{caption:"Copy Directory",linkurl:"javascript:copyFile('"+e+"')",classname:"copy"},{caption:"Rename Directory",linkurl:"javascript:renameFile('"+e+"', true)",classname:"rename"},{caption:"Cut Directory",linkurl:"javascript:cutFile('"+e+"')",classname:"cut"},{caption:"Move Directory",linkurl:"javascript:moveFile('"+e+"', true)",classname:"move"},{caption:"Delete Directory",linkurl:"javascript:deleteDirectory('"+e+"')",classname:"delete"},{caption:"Compress Directory",linkurl:"javascript:compressFile('"+e+"')",classname:"compress"},{caption:"Set Permission",linkurl:"javascript:changePermission('"+e+"')",classname:"permission"},{caption:"Directory Properties",linkurl:"javascript:propertyDir('"+e+"')",classname:"property"}],t}function goToUpDir(){openDir(dirname($("#address").val()))}function forceDownloadFile(e){window.open("tool-download-file.php?filepath="+encodeURIComponent(e))}function previewFile(e,t,i,a,l){let o=t,n=i,r="",s=basename(e);arrthumbnail.length&&(thumbnailIndexCur=$.inArray(e,arrthumbnailURL),-1==thumbnailIndexCur?(thumbnailIndexCur=0,thumbnailIndexNext=0,thumbnailIndexPrev=0):0==thumbnailIndexCur?(thumbnailIndexNext=thumbnailIndexCur+1,thumbnailIndexPrev=arrthumbnailURL.length-1):thumbnailIndexCur>=arrthumbnailURL.length?(thumbnailIndexNext=0,thumbnailIndexPrev=arrthumbnailURL.length-1):(thumbnailIndexNext=thumbnailIndexCur+1,thumbnailIndexPrev=thumbnailIndexCur-1),thumbnailIndexNext%=arrthumbnailURL.length,thumbnailIndexPrev%=arrthumbnailURL.length,thumbnailIndexNext<0&&(thumbnailIndexNext=0));let d="../../"+e;a?r='<img src="'+d+'" width="'+o+'" height="'+n+'" class="image2zoomout" title="'+s+'" onclick="previewFile(\''+e+"', '"+t+"', '"+i+"', false);\" />":(t>500&&(o=500,n=i/t*o),r='<img src="'+d+'" width="'+o+'" height="'+n+'" class="image2zoomin" title="'+s+'" onclick="previewFile(\''+e+"', '"+t+"', '"+i+"', true);\" />");let c={};c.url=arrthumbnail[thumbnailIndexPrev].url,c.width=arrthumbnail[thumbnailIndexPrev].image_width,c.height=arrthumbnail[thumbnailIndexPrev].image_height;let p={};p.url=arrthumbnail[thumbnailIndexNext].url,p.width=arrthumbnail[thumbnailIndexNext].image_width,p.height=arrthumbnail[thumbnailIndexNext].image_height;let m=Math.round(n/2-3),u=0,h=o-8,f=m+32,g=h-90,v="",b="",y="";if(v+='<div class="nav-thumb nav-thum-prev" style="top:'+m+"px;left:"+u+'px;" onclick="previewFile(\''+c.url+"', "+c.width+", "+c.height+');">&lt;</div>',b+='<div class="nav-thumb nav-thum-next" style="top:'+m+"px;left:"+h+'px;" onclick="previewFile(\''+p.url+"', "+p.width+", "+p.height+');">&gt;</div>',y+='<div class="tool-thumb" style="top:'+f+"px;left:"+g+'px;"><a href="javascript:;" onclick="selectFileIndex(\''+e+'\');" title="Select Image"><img src="style/images/trans16.gif" class="select" border="0"></a> <a href="javascript:;" onclick="window.open(\''+e+'\');" title="Download Image"><img src="style/images/trans16.gif" class="download" border="0"></a> <a href="javascript:;" onclick="editImage(\''+relative2absolute(e)+'\');closeOverlayDialog();" title="Edit Image"><img src="style/images/trans16.gif" class="edit-image" border="0"></a> <a href="javascript:;" onclick="propertyImage(\''+relative2absolute(e)+'\');" title="Image Properties"><img src="style/images/trans16.gif" class="property" border="0"></a> </div>',o>60&&arrthumbnail.length>1&&(r+=v+b+y),l&&togglethumb){let t=$('li[data-file-url="'+e+'"] .thumbimage img'),i=parseFloat(t.offset().left),a=parseFloat(t.offset().top),l=96;n>o&&(l=96*o/n,i+=(96-l)/2);let s=96;o>n&&(s=96*n/o,a+=(96-s)/2);let d=(parseFloat($(window).width())-o)/2,c=(parseFloat($(window).height())-n)/2,p="url(tool-thumb-image.php?filepath="+encodeURIComponent(relative2absolute(e))+")";$("<img />").addClass("anim-preview").attr("src",e).css({"background-image":p,"background-size":"100%",width:l+"px",height:s+"px",left:i+"px",top:a+"px",position:"absolute","z-index":"5000"}).appendTo("body"),$(".anim-preview").animate({left:d,top:c,width:o,height:n},200,function(){$(".anim-preview").remove(),overlayDialog(r,o,n),$(".image2zoomout, .image2zoomin").on("mouseover",function(){let e=$(this).attr("src");$('li[data-file-url="'+e+'"] .thumbitem').addClass("thumbitem-selected")}),$(".image2zoomout, .image2zoomin").on("mouseout",function(){let e=$(this).attr("src");$('li[data-file-url="'+e+'"] .thumbitem').removeClass("thumbitem-selected")})})}else overlayDialog(r,o,n),$(".image2zoomout, .image2zoomin").on("mouseover",function(){let e=$(this).attr("src");$('li[data-file-url="'+e+'"] .thumbitem').addClass("thumbitem-selected")}),$(".image2zoomout, .image2zoomin").on("mouseout",function(){let e=$(this).attr("src");$('li[data-file-url="'+e+'"] .thumbitem').removeClass("thumbitem-selected")})}function preloadImage(){$(document).on("hover",'.row-data-file[data-file-type*="image"]',function(){let e=$(this).attr("data-file-url"),t=parseInt($(this).attr("data-image-width")),i=parseInt($(this).attr("data-image-height")),a=new Image(t,i);a.src=e})}function playVideo(e,t){let i="../../"+e,a="",l=500,o=375;null!=videoDimensions[i]&&(o=l*videoDimensions[i].height/videoDimensions[i].width);let n=$(document).height(),r=$(document).width();o>n-60&&(o=n-60,l=o*videoDimensions[i].width/videoDimensions[i].height),l>r-60&&(l=r-60,o=l*videoDimensions[i].height/videoDimensions[i].width),a="iframe"==t?'<iframe frameborder="0" hspace="0" vspace="0" marginheight="0" marginwidth="0" scrolling="auto" src="'+e+'" width="'+l+'" height="'+o+'" /></ifame>':"html5"==t?'<video src="'+i+'" poster="style/images/movie.png" controls="true" width="'+l+'" height="'+o+'"><object width="'+l+'" height="'+o+'" type="application/x-shockwave-flash" data="moxieplayer.swf"><param name="url" value="'+i+'"><param name="src" value="moxieplayer.swf"><param name="allowfullscreen" value="true"><param name="allowscriptaccess" value="true"><param name="autoplay" value="true"><param name="flashvars" value="url='+e+'&amp;poster=style/images/movie.png&amp;autoplay=true"></object></video>':"moxie"==t?'<object width="'+l+'" height="'+o+'" type="application/x-shockwave-flash" data="moxieplayer.swf"><param name="url" value="'+i+'"><param name="src" value="moxieplayer.swf"><param name="allowfullscreen" value="true"><param name="allowscriptaccess" value="true"><param name="autoplay" value="true"><param name="flashvars" value="url='+i+'&amp;poster=style/images/movie.png&amp;autoplay=true"></object>':'<object width="'+l+'" height="'+o+'" data="'+i+'" type="application/x-mplayer2"><param name="url" value="'+i+'" /></object>',overlayDialog(a,l,o)}function playAudio(e,t){let i="../../"+e,a="";a="iframe"==t?'<iframe frameborder="0" hspace="0" vspace="0" marginheight="0" marginwidth="0" scrolling="auto" src="'+e+'" width="320" height="50" /></ifame>':"html5"==t?'<video src="'+i+'" controls="true" width="320" height="50"><object width="320" height="50" data="'+e+'" type="application/x-mplayer2"><param name="url" value="'+i+'" /></object></video>':"moxie"==t?'<object width="320" height="50" type="application/x-shockwave-flash" data="moxieplayer.swf"><param name="url" value="'+i+'"><param name="src" value="moxieplayer.swf"><param name="allowfullscreen" value="true"><param name="allowscriptaccess" value="true"><param name="autoplay" value="true"><param name="flashvars" value="url='+i+'&amp;poster=style/images/audio.png&amp;autoplay=true"></object>':'<object width="320" height="50" data="'+i+'" type="application/x-mplayer2"><param name="url" value="'+i+'" /></object>',overlayDialog(a,320,50)}function compressAudio(e){$("#common-dialog-inner").html("Compress audio will reduce the quality and file size. This process can not be undone.<br />Are you sure yo want to compress this audio?"),$("#common-dialog").dialog({modal:!0,title:"Compress Audio",width:330,height:180,buttons:{Yes:function(){$("#common-dialog").parent().find(".ui-dialog-buttonpane").find("button").each(function(e,t){$(this).prop("disabled",!0)}),$("#common-dialog").html("Please wait while audio file is being compressed.");let t="?option=compress-audio";t=updateQueryParam(t),$.post("tool-file-operation.php"+t,{path:e},function(e){"SUCCESS"==e?openDir($("#fftargetdir").val()):alert("File type can not be compressed.");try{$("#common-dialog").dialog("destroy")}catch(e){}})},No:function(){$(this).dialog("destroy")}}})}function previewPDF(e){let t="../../"+e,i='<embed src="'+t+'#toolbar=0&amp;navpanes=0&amp;scrollbar=0" width="720" height="400">';overlayDialog(i,720,400)}function previewSWF(e,t,i){let a="../../"+e,l='<object width="'+t+'" height="'+i+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0"><param name="src" value="'+a+'"><embed src="'+a+'" width="'+t+'" height="'+i+'"></embed></object>';overlayDialog(l,t,i)}function propertyFile(e){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"File Properties",width:400,height:270,buttons:{Close:function(){$(this).dialog("destroy")}}});let t=getQueryParams();t.filepath=e,$.get("tool-property-file.php",t,function(t){$("#common-dialog-inner").html(t);let i=$(".mime-type").attr("data-content");"application/zip"==i&&($(".ui-dialog-buttonset").prepend('<button aria-disabled="false" role="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" type="button"><span class="ui-button-text">Show Content</span></button>'),$(".ui-dialog-buttonset").find("button:first").attr("onclick","showZipContent('"+e+"')"))})}function propertyImage(e){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Image Properties",width:400,height:410,buttons:{Close:function(){$(this).dialog("destroy")}}});let t=getQueryParams();t.filepath=e,t.type="image",$.get("tool-property-file.php",t,function(e){$("#common-dialog-inner").html(e)})}function propertyVideo(e){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Video Properties",width:400,height:410,buttons:{Close:function(){$(this).dialog("destroy")}}});let t=getQueryParams();t.filepath=e,t.type="video",$.get("tool-property-file.php",t,function(e){$("#common-dialog-inner").html(e)})}function propertyDir(e){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Directory Properties",width:400,height:230,buttons:{Close:function(){$(this).dialog("destroy")}}});let t=getQueryParams();t.filepath=e,t.type="directory",$.get("tool-property-file.php",t,function(e){$("#common-dialog-inner").html(e)})}function showZipContent(e){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Zip Content",width:400,height:230,buttons:{"Extract File":function(){extractFile(e)},Close:function(){$(this).dialog("destroy")}}});let t=getQueryParams();t.filepath=e,$.get("tool-zip-content.php",t,function(e){$("#common-dialog-inner").html(e)})}function renameFile(e,t){if(!e){let i;$(".fileid:checked").each(function(a){null==i&&(i=$(this).attr("value"),null!=i&&(e=i,"true"==$(this).attr("data-isdir")&&(t=!0)))})}let i="";if(e){$("#common-dialog-inner").html(""),i=t?"Rename Directory":"Rename File",$("#common-dialog").dialog({modal:!0,title:i,width:400,height:200,buttons:{OK:function(){let e,i,a=$("#fflocation").val(),l=$("#ffoldname").val(),o=$("#ffnewname").val();try{e=getfileExtension(l.trim())}catch(t){e=getfileExtension(l)}try{i=getfileExtension(o.trim())}catch(e){i=getfileExtension(o)}try{o=o.trim()}catch(e){}if(""==o)jqAlert("Please type new name.","Input Needed"),$("#ffnewname").val(l),$("#ffnewname").select();else if(l==o)jqAlert("New name and old name must be different.","Invalid Name");else{if(e.toString()!=i.toString()&&!t&&!confirm("The new file extension is different with old one.\nIf you change a file name extension, the file might become unusable.\nAre you sure you want to change it?"))return;let n="?option=renamefile";n=updateQueryParam(n),$.post("tool-file-operation.php"+n,{location:a,oldname:l,newname:o},function(e){if("SUCCESS"==e){openDir(a);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"EXIST"==e?jqAlert(o+" already exists. Please type another name.","Invalid Name"):"READONLY"==e?jqAlert("The operation was disabled on read-only mode.","Read-Only"):"FORBIDDENEXT"==e&&jqAlert("The operation was aborted because this file name extension is forbidden. Please use another file name extension.","Forbidden Extension")})}},Cancel:function(){$(this).dialog("destroy")}}});let a='<form id="formfilerename" name="form1" method="post" action=""><table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">Location</td><td><input type="text" name="fflocation" id="fflocation" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>Current Name</td><td><input type="text" name="ffoldname" id="ffoldname" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>New Name</td><td><input type="text" name="ffnewname" id="ffnewname" class="input-text" autocomplete="off" /></td></tr></table></form>';$("#common-dialog-inner").html(a),$("#fflocation").val(dirname(e)),$("#ffoldname, #ffnewname").val(basename(e));let l=removefileextension($("#ffnewname").val()),o=0,n=l.length;setInputSelection(document.getElementById("ffnewname"),o,n)
}else jqAlert("No file or directory selected.","Invalid Operation")}function compressFile(e){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Compress File",width:400,height:175,buttons:{OK:function(){$(".ui-dialog-buttonpane").append('<div class="wait-status">Plase wait...</div>'),$(".ui-dialog-buttonset button:first").attr("disabled","disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","true");let t=$("#ffsourcepath").val(),i=$("#fftargetpath").val(),a="?option=compressfile";a=updateQueryParam(a),$.post("tool-file-operation.php"+a,{"sourcepath[]":t,targetpath:i},function(t){if("CONFLICT"==t)jqAlert(e+" already exists. Please enter another name.","Invalid Name");else if("SUCCESS"==t){openDir(dirname(i));try{$("#common-dialog").dialog("destroy")}catch(e){}}else"FAILED"==t?jqAlert("The operation was failed.","Unknown Error Occured"):"NOTSUPPORTED"==t?jqAlert("The operation was failed.","ZipArchive class not exists. Please verify that php_zip extension is available on this server."):"READONLY"==t&&jqAlert("The operation was disabled on read-only mode.","Read-Only");$(".ui-dialog-buttonpane").find(".wait-status").remove(),$(".ui-dialog-buttonset button:first").removeAttr("disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","false")})},Cancel:function(){$(this).dialog("destroy")}}});let t='<form id="formfilerename" name="form1" method="post" action=""><table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">Source Name</td><td><input type="text" name="ffsourcepath" id="ffsourcepath" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>Target Name</td><td><input type="text" name="fftargetpath" id="fftargetpath" class="input-text" autocomplete="off" /></td></tr></table></form>';$("#common-dialog-inner").html(t),$("#ffsourcepath").val(e),$("#fftargetpath").val(removefileextension(e)+".zip");let i=dirname($("#fftargetpath").val()),a=i.length+1,l=removefileextension(basename($("#fftargetpath").val())),o=a+l.length;setInputSelection(document.getElementById("fftargetpath"),a,o)}function compressSelectedFile(){let e=$("#address").val(),t="",i=0,a="";if($(".fileid:checked").each(function(e){t+="<div>"+$(this).val()+"</div>",i++}),i){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Compress File",width:400,height:260,buttons:{OK:function(){$(".ui-dialog-buttonpane").append('<div class="wait-status">Plase wait...</div>'),$(".ui-dialog-buttonset button:first").attr("disabled","disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","true");let e=$("#fftargetpath").val(),t="targetpath="+encodeURIComponent(e);$(".fileid:checked").each(function(e){t+="&sourcepath[]="+encodeURIComponent($(this).val())});let i="?option=compressfile";i=updateQueryParam(i),$.post("tool-file-operation.php"+i,{postdata:t},function(t){if("SUCCESS"==t||"EXIST"==t){openDir(dirname(e));try{$("#common-dialog").dialog("destroy")}catch(e){}}if("CONFLICT"==t)jqAlert("Please enter another name.","Invalid Name");else if("SUCCESS"==t){openDir(dirname(tf));try{$("#common-dialog").dialog("destroy")}catch(e){}}else"FAILED"==t?jqAlert("The operation was failed.","Unknown Error Occured"):"NOTSUPPORTED"==t?jqAlert("The operation was failed.","ZipArchive class not exists. Please verify that php_zip extension is available on this server."):"READONLY"==t&&jqAlert("The operation was disabled on read-only mode.","Read-Only");$(".ui-dialog-buttonpane").find(".wait-status").remove(),$(".ui-dialog-buttonset button:first").removeAttr("disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","false")})},Cancel:function(){$(this).dialog("destroy")}}}),a='<table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">Target Name</td><td><input type="text" name="fftargetpath" id="fftargetpath" class="input-text" autocomplete="off" /></td></tr></table><div></div><div>File to be compressed:</div><div class="seleted-file-list">'+t+"</div></div>",$("#common-dialog-inner").html(a);let i="new-compressed",l=1,o="",n=1,r=1;do{o=l>1?i+"-"+l+".zip":i+".zip",n=$('.file-area .row-data-dir[data-file-name="'+o+'"]').length,r=$('.file-area .row-data-file[data-file-name="'+o+'"]').length,l++}while(n||r);$("#fftargetpath").val(e+"/"+o),o=dirname($("#fftargetpath").val());let s=o.length+1,d=removefileextension(basename($("#fftargetpath").val())),c=s+d.length;setInputSelection(document.getElementById("fftargetpath"),s,c)}else jqAlert("No file selected.","Invalid Operation")}function moveSelectedFile(){let e=$("#address").val(),t="",i=0,a="";$(".fileid:checked").each(function(e){t+="<div>"+$(this).val()+"</div>",i++}),i?($("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Move File",width:400,height:260,buttons:{OK:function(){let t=$("#fftargetdir").val();if(e!=t){let e="targetdir="+encodeURIComponent(t);$(".fileid:checked").each(function(t){e+="&file[]="+encodeURIComponent($(this).val())});let i="?option=copyfile&deletesource=1";$.post("tool-file-operation.php"+i,{postdata:e},function(e){if("SUCCESS"==e||"EXIST"==e){openDir($("#fftargetdir").val());try{$("#common-dialog").dialog("destroy")}catch(e){}}else"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only");$(".ui-dialog-buttonpane").find(".wait-status").remove(),$(".ui-dialog-buttonset button:first").removeAttr("disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","false")})}else jqAlert("Please enter another name.","Invalid Name")},Cancel:function(){$(this).dialog("destroy")}}}),a='<table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">New Location</td><td><input type="text" name="fftargetdir" id="fftargetdir" class="input-text" autocomplete="off" /></td></tr></table><div></div><div>File to be moved:</div><div class="seleted-file-list">'+t+"</div></div>",$("#common-dialog-inner").html(a),$("#fftargetdir").focus(),$("#fftargetdir").val(e)):jqAlert("No file selected.","Invalid Operation")}function extractFile(e){if(!e){let t=$(".fileid:checked[data-iszip=true]").attr("value");if(null==t)return void jqAlert("No file selected.","Invalid Operation");e=t}$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Extract File",width:400,height:175,buttons:{OK:function(){$(".ui-dialog-buttonpane").append('<div class="wait-status">Plase wait...</div>'),$(".ui-dialog-buttonset button:first").attr("disabled","disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","true");let e=$("#ffsourcename").val(),t=$("#fftargetdir").val(),i="?option=extractfile";i=updateQueryParam(i),$.post("tool-file-operation.php"+i,{filepath:e,targetdir:t},function(e){if("SUCCESS"==e){openDir(t);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"FAILED"==e?jqAlert("This is not a Zip file.","Invalid Format"):"NOTSUPPORTED"==e?jqAlert("The operation was failed.","ZipArchive class not exists. Please verify that php_zip extension is available on this server."):"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})},Cancel:function(){$(this).dialog("destroy")}}});let t='<form id="formfilerename" name="form1" method="post" action=""><table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">Source Name</td><td><input type="text" name="ffsourcename" id="ffsourcename" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>Target Location</td><td><input type="text" name="fftargetdir" id="fftargetdir" class="input-text" autocomplete="off" /></td></tr></table></form>';$("#common-dialog-inner").html(t),$("#ffsourcename").val(e),$("#fftargetdir").val(dirname(e))}function createFile(){let e=$("#address").val();$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Create New File",width:400,height:200,buttons:{OK:function(){let e=$("#fflocation").val(),t=$("#ffname").val(),i="?option=createfile";i=updateQueryParam(i),$.post("tool-file-operation.php"+i,{location:e,name:t},function(i){if("EXIST"==i)jqAlert(e+"/"+t+" already exists. Please type another name."),$("#ffname").select();else if("SUCCESS"==i){openDir(e);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"FORBIDDENEXT"==i?jqAlert("Creating file was aborted because this file name extension is forbidden. Please use another file name extension.","Forbidden Extension"):"READONLY"==i&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})},Cancel:function(){$(this).dialog("destroy")}}});let t='<form id="formfilecreate" name="form1" method="post" action=""><table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">Location</td><td><input type="text" name="fflocation" id="fflocation" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>Directory Name</td><td><input type="text" name="ffname" id="ffname" class="input-text" autocomplete="off" /></td></tr></table></form>';$("#common-dialog-inner").html(t),$("#fflocation").val(e);let i="new-file",a=1,l=1,o=1;do{e=a>1?i+"-"+a+".txt":i+".txt",l=$('.file-area .row-data-dir[data-file-name="'+e+'"]').length,o=$('.file-area .row-data-file[data-file-name="'+e+'"]').length,a++}while(l||o);$("#ffname").val(e);let n=removefileextension(e),r=0,s=n.length;setInputSelection(document.getElementById("ffname"),r,s)}function createDirectory(){let e=$("#address").val();$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Create Directory",width:400,height:200,buttons:{OK:function(){let e=$("#fflocation").val(),t=$("#ffname").val(),i="?option=createdir";i=updateQueryParam(i),$.post("tool-file-operation.php"+i,{location:e,name:t},function(i){if("EXIST"==i)jqAlert(e+"/"+t+" already exists. Please type another name."),$("#ffname").select();else if("SUCCESS"==i){openDir(e);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"READONLY"==i&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})},Cancel:function(){$(this).dialog("destroy")}}});let t='<form id="formfilerename" name="form1" method="post" action=""><table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">Location</td><td><input type="text" name="fflocation" id="fflocation" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>Directory Name</td><td><input type="text" name="ffname" id="ffname" class="input-text" autocomplete="off" /></td></tr></table></form>';$("#common-dialog-inner").html(t),$("#fflocation").val(e);let i="new-directory",a=1,l=1,o=1;do{e=a>1?i+"-"+a:i,l=$('.file-area .row-data-dir[data-file-name="'+e+'"]').length,o=$('.file-area .row-data-file[data-file-name="'+e+'"]').length,a++}while(l||o);$("#ffname").val(e),$("#ffname").select()}function moveFile(e,t){$("#common-dialog-inner").html("");let i="";i=t?"Move Directory":"Move File",$("#common-dialog").dialog({modal:!0,title:i,width:400,height:190,buttons:{OK:function(){$(".ui-dialog-buttonpane").append('<div class="wait-status">Plase wait...</div>'),$(".ui-dialog-buttonset button:first").attr("disabled","disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","true");let e=$("#address").val(),t=$("#ffnewlocation").val(),i=$("#ffcurrentlocation").val(),a="targetdir="+encodeURIComponent(t);a+="&file[]="+encodeURIComponent(i+"/"+$("#ffpath").val());let l="?option=copyfile&deletesource=1";$.post("tool-file-operation.php"+l,{postdata:a},function(t){if("SUCCESS"==t||"EXIST"==t){openDir(e);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"READONLY"==t&&jqAlert("The operation was disabled on read-only mode.","Read-Only");$(".ui-dialog-buttonpane").find(".wait-status").remove(),$(".ui-dialog-buttonset button:first").removeAttr("disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","false")})},Cancel:function(){$(this).dialog("destroy")}}});let a='<form id="formfilemove" name="form1" method="post" action=""><table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table"><tr><td width="30%">Base Name</td><td><input type="text" name="ffpath" id="ffpath" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>Current Location</td><td><input type="text" name="ffcurrentlocation" id="ffcurrentlocation" class="input-text" autocomplete="off" readonly="readonly" /></td></tr><tr><td>New location</td><td><input type="text" name="ffnewlocation" id="ffnewlocation" class="input-text" autocomplete="off" /></td></tr></table></form>';$("#common-dialog-inner").html(a),$("#ffpath").val(basename(e)),$("#ffcurrentlocation").val(dirname(e)),$("#ffnewlocation").focus(),$("#ffnewlocation").val(dirname(e))}function uploadFile(){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Upload File",width:600,height:410,buttons:{Close:function(){$(this).dialog("destroy")}}});let e=$("#address").val(),t='<div id="imageuploader"><form method="post" enctype="multipart/form-data" action="tool-upload-file.php?iframe=1" target="formdumper"><input type="hidden" name="targetdir" id="targetdir" value="">File <input type="file" name="file" id="images" /><input type="submit" class="upload-button" value="Upload Files" style="display:none" /> &nbsp; <span id="image-settings-controller"></span></form><div id="response"></div><ul id="image-list"></ul></div><iframe style="display:none; width:0px; height:0px;" id="formdumper" name="formdumper"></iframe></div>';$("#common-dialog-inner").html(t);let i=getQueryParams();i["show-control"]="1",$.get("tool-upload-file-settings.php",i,function(e){$("#image-settings-controller").html(e)}),$("#targetdir").val(e),$.ajax({type:"GET",url:"js/upload.min.js",dataType:"script"})}function saveFile(e,t,i){if(""==e)jqAlert("Please enter a valid file name.","Invalid File Name");else{$(".ui-dialog-buttonpane").append('<div class="wait-status">Plase wait...</div>'),$(".ui-dialog-buttonset button:first").attr("disabled","disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","true");let a="?option=savefile";a=updateQueryParam(a),$.post("tool-edit-file.php"+a,{filepath:e,filecontent:t},function(e){"READONLY"==e?jqAlert("The operation was disabled on read-only mode.","Read-Only"):"READONLYFILE"==e?jqAlert("Saving was aborted because this file is read-only. You should to change permission of this file first.","Read-Only"):"ISDIR"==e?jqAlert("Saving was aborted because this file name is similiar to a directory name. You should to change file name first.","Invalid File Name"):"FORBIDDENEXT"==e?jqAlert("Saving was aborted because this file name extension is forbidden. Please use another file name extension to save it.","Forbidden Extension"):"NOTMODIFIED"==e?jqAlert("Content is not modified.","Not Modified"):("function"==typeof i&&i(),openDir()),$(".ui-dialog-buttonpane").find(".wait-status").remove(),$(".ui-dialog-buttonset button:first").removeAttr("disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","false")})}}function setActiveCompress(e){let t=e?1:0,i="?";i=updateQueryParam(i),$.post("tool-upload-file-settings.php"+i,{"change-state":"change-state",state:t},function(e){})}function uploadFileSettings(){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Upload File Settings",width:420,height:270,buttons:{Save:function(){let e=$("#uploadsetting").serialize(),t="?";t=updateQueryParam(t),$.post("tool-upload-file-settings.php"+t,{save:"save",data:e},function(e){}),$(this).dialog("close")},Cancel:function(){$(this).dialog("destroy")}}});let e=getQueryParams();e["show-form"]="1",$.get("tool-upload-file-settings.php",e,function(e){$("#common-dialog-inner").html(e)})}function openFile(e){cnt2=$("#filecontent").val();let t=!0;cnt1!=cnt2&&(t=confirm("Are you sure you want to reopen file without save change?")),t&&editFile(e)}function editFile(e){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Edit Text File",closeOnEscape:!1,resizable:!0,width:600,height:410,buttons:{Save:function(){saveFile($("#filepath").val(),$("#filecontent").val()),cnt1=$("#filecontent").val()},"Save and Close":function(){saveFile($("#filepath").val(),$("#filecontent").val(),function(){$("#common-dialog").dialog("destroy")})},"Close without Save":function(){cnt2=$("#filecontent").val(),cnt1!=cnt2?confirm("Are you sure you want to close without save?")&&$(this).dialog("destroy"):$(this).dialog("destroy")}},resize:function(e,t){$("#filecontent").css({height:t.size.height-158+"px"})}}),$(".ui-dialog-titlebar-close").remove();let t=getQueryParams();t.option="openfile",t.filepath=e,$.get("tool-edit-file.php",t,function(e){$("#common-dialog-inner").html(e),cnt1=$("#filecontent").val()})}function deleteFile(e){let t=dirname(e);$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Delete File",width:400,height:175,buttons:{OK:function(){let i="";i="file[]="+e;let a="?option=deletefile";a=updateQueryParam(a),$.post("tool-file-operation.php"+a,{postdata:i},function(e){if("SUCCESS"==e){openDir(t);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})},Cancel:function(){$(this).dialog("destroy")}}});let i="<div>Are you sure to delete this file:<br />"+e+"</div>";$("#common-dialog-inner").html(i),$(".ui-dialog-buttonset button:last").focus()}function deleteDirectory(e){let t=$("#address").val();$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Delete Directory",width:400,height:175,buttons:{OK:function(){let i="";i="file[]="+e;let a="?option=deletefile";a=updateQueryParam(a),$.post("tool-file-operation.php"+a,{postdata:i},function(e){if("SUCCESS"==e){openDir(t);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})},Cancel:function(){$(this).dialog("destroy")}}});let i="<div>Are you sure to delete this directory including its content:<br />"+e+"</div>";$("#common-dialog-inner").html(i),$(".ui-dialog-buttonset button:last").focus()}function deleteSelectedFile(){let e=$("#address").val(),t="",i="",a=0,l="";$(".fileid:checked").each(function(e){i+="<div>"+$(this).val()+"</div>",t+="&file[]="+encodeURIComponent($(this).val()),a++}),a?($("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Delete File",width:400,height:250,buttons:{OK:function(){let i="?option=deletefile";i=updateQueryParam(i),$.post("tool-file-operation.php"+i,{postdata:t},function(t){if("SUCCESS"==t){openDir(e);try{$("#common-dialog").dialog("destroy")}catch(e){}}else"READONLY"==t&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})},Cancel:function(){$(this).dialog("destroy")}}}),l='<div>Are you sure to delete file/s:</div><div class="seleted-file-list">'+i+"</div></div>",$("#common-dialog-inner").html(l),$(".ui-dialog-buttonset button:last").focus()):jqAlert("No file selected.","Invalid Operation")}function selectAll(e){if(e){let e,t=$(".fileid").length;for(e=0;e<t;e++)$(".fileid")[e].checked=!0;try{$("#control-fileid")[0].checked=!0}catch(e){}}else{let e,t=$(".fileid").length;for(e=0;e<t;e++)$(".fileid")[e].checked=!1;try{$("#control-fileid")[0].checked=!1}catch(e){}}updateToolbarStatus()}function thumbnail(){let e=$("#address").val();togglethumb=!togglethumb,togglethumb?$("#tb-thumbnail").addClass("tb-selected"):$("#tb-thumbnail").removeClass("tb-selected");let t=new Array;$(".fileid:checked").each(function(e){t[t.length]=$(this).val()});let i=togglethumb?1:0;cookieWrite("togglethumb",i,24),openDir(e,t)}function refreshList(){let e=$("#address").val(),t=new Array;$(".fileid:checked").each(function(e){t[t.length]=$(this).val()}),openDir(e,t)}function transferFile(){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Transfer File",width:400,height:200,buttons:{"Get File":function(){let e=$("#source").val(),t=$("#target").val(),i=$("#filename").val(),a="?option=transferfile";a=updateQueryParam(a),$.post("tool-file-operation.php"+a,{source:e,location:t,name:i},function(e){if("READONLY"==e)jqAlert("The operation was disabled on read-only mode.","Read-Only");else if("FAILED"==e)jqAlert("Transfer file failed.","Failed");else{try{$("#common-dialog").dialog("destroy")}catch(e){}openDir(t)}})},Cancle:function(){try{$("#common-dialog").dialog("destroy")}catch(e){}}}});let e='<form name="form1" method="post" action=""><table width="100%" border="0" cellspacing="0" cellpadding="0" class="dialog-table"><tr><td width="30%">URL</td><td><input type="text" name="source" class="form-control input-text" id="source" data-needed="true" autocomplete="off" /></td></tr><tr><td>Target Location</td><td><input type="text" name="target" class="form-control input-text" id="target" data-needed="true" autocomplete="off" /></td></tr><td>File Name</td><td><input type="text" name="filename" class="form-control input-text" id="filename" data-needed="true" autocomplete="off" /></td></tr></table></form>';$("#common-dialog-inner").html(e);let t=$("#address").val();$("#target").val(t),$("#source").on("change",function(){let e=$(this).val(),t="";t=0==e.indexOf("data:")?dataToFileName(e):filterFileName(basename($(this).val())),$("#filename").val(t)}),$("#source").on("keyup",function(){let e=$(this).val(),t="";t=0==e.indexOf("data:")?dataToFileName(e):filterFileName(basename($(this).val())),$("#filename").val(t)})}function dataToFileName(e){let t=e.split(","),i=t[0].split(":"),a=i[1].split(";"),l=a[0].split("/").join(".");return l}function filterFileName(e){return e.replace(/[^A-Za-z\.\-\d_\/]/g,"")}function copySelectedFile(){this.operation="copy",this.content=new Array;let e=this,t=0;$(".fileid:checked").each(function(i){e.content[e.content.length]=$(this).val(),t++}),clipboardfile=e,0==t?jqAlert("No file selected.","Invalid Operation"):($("#tb-clipboard").removeClass("tb-hide"),$("#tb-clipboard-empty").removeClass("tb-hide")),updateToolbarStatus()}function cutSelectedFile(){this.operation="cut",this.content=new Array;let e=this,t=0;$(".fileid:checked").each(function(i){e.content[e.content.length]=$(this).val(),t++}),clipboardfile=e,0==t?jqAlert("No file selected.","Invalid Operation"):($("#tb-clipboard").removeClass("tb-hide"),$("#tb-clipboard-empty").removeClass("tb-hide")),updateToolbarStatus()}function cutFile(e){if(e){this.operation="cut",this.content=new Array;let t=this;t.content[t.content.length]=e,clipboardfile=t,$("#tb-clipboard").removeClass("tb-hide"),$("#tb-clipboard-empty").removeClass("tb-hide"),updateToolbarStatus()}else jqAlert("No file selected.","Invalid Operation")}function copyFile(e){if(e){this.operation="copy",this.content=new Array;let t=this;t.content[t.content.length]=e,clipboardfile=t,$("#tb-clipboard").removeClass("tb-hide"),$("#tb-clipboard-empty").removeClass("tb-hide"),updateToolbarStatus()}else jqAlert("No file selected.","Invalid Operation")}function pasteFile(){let e=0,t=$("#address").val();if(clipboardfile.content.length){let i="targetdir="+encodeURIComponent(t);for(e in clipboardfile.content)i+="&file[]="+encodeURIComponent(clipboardfile.content[e]);let a="?option=copyfile";"cut"==clipboardfile.operation&&(a+="&deletesource=1"),a=updateQueryParam(a),$.post("tool-file-operation.php"+a,{postdata:i},function(e){"SUCCESS"==e||"EXIST"==e?(openDir(t),"cut"==clipboardfile.operation&&emptyClipboard()):"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})}else jqAlert("The clipboard is empty.","Invalid Operation");updateToolbarStatus()}function emptyClipboard(){clipboardfile.content=new Array,clipboardfile.operation="",$("#tb-clipboard").addClass("tb-hide"),$("#tb-clipboard-empty").addClass("tb-hide"),updateToolbarStatus()}function showClipboard(){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Clipboard Content",width:400,height:230,buttons:{Close:function(){$(this).dialog("destroy")}}});let e="<div>File Operation: &quot;"+clipboardfile.operation+"&quot;; Number of File: "+clipboardfile.content.length+'</div><div class="seleted-file-list">'+clipboardfile.content.join("<br />")+"</div>";$("#common-dialog-inner").html(e)}function changePermission(filepath){let data=[];if(filepath?data=[filepath]:$(".fileid:checked").each(function(e,t){data.push($(this).val())}),1==data.length&&(filepath=data[0]),initPermissionControl(),$("#common-dialog-inner").html('<table width="100%" border="0" cellspacing="1" cellpadding="2" class="table table-striped table-sm file-table permission-table"><thead>  <tr>    <td>User</td>    <td width="25%">Read</td>    <td width="25%">Write</td>    <td width="25%">Execute</td>  </tr></thead><tbody>  <tr>    <td>Owner</td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="user_read" checked="checked"> Allowed</label></td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="user_write"> Allowed</label></td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="user_execute" checked="checked"> Allowed</label></td>  </tr>  <tr>    <td>Group</td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="group_read" checked="checked"> Allowed</label></td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="group_write"> Allowed</label></td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="group_execute" checked="checked"> Allowed</label></td>  </tr>  <tr>    <td>World</td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="world_read" checked="checked"> Allowed</label></td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="world_write"> Allowed</label></td>    <td><label><input type="checkbox" class="perm-checkbox" value="1" name="world_execute" checked="checked"> Allowed</label></td>  </tr>  <tr>    <td>Permission</td>    <td colspan="3"><input type="text" id="file-permission" name="file-permission" class="form-control input-text input-text-medium" value="0555" readonly="readonly"> <span id="recursive-control"><label><input type="checkbox" class="recursive" value="1" name="recursive"> Recursive to contents</label><span></td>    </tr></tbody></table>'),$("#common-dialog").dialog({modal:!0,title:"Set Permission",width:400,height:250,buttons:{Change:function(){if(0==data.length)jqAlert("No file selected.","Invalid Operation");else{$(".ui-dialog-buttonpane").append('<div class="wait-status">Plase wait...</div>'),$(".ui-dialog-buttonset button:first").attr("disabled","disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","true");let e=$("#recursive:checked").val(),t=$("#file-permission").val(),i="?option=change-perms";i=updateQueryParam(i),$.post("tool-file-operation.php"+i,{recursive:e,perms:t,data:data},function(e){if("SUCCESS"==e){try{$("#common-dialog").dialog("destroy")}catch(e){}openDir()}else"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only");$(".ui-dialog-buttonpane").find(".wait-status").remove(),$(".ui-dialog-buttonset button:first").removeAttr("disabled"),$(".ui-dialog-buttonset button:first").attr("aria-disabled","false")})}},Close:function(){$(this).dialog("destroy")}}}),filepath){let data=getQueryParams();data.option="get-perms",data.filepath=filepath,$.get("tool-file-operation.php",data,function(answer){let obj=eval(answer)[0],i;for(i in obj)-1!=i.indexOf("_")?"1"==obj[i]?$('input[name="'+i+'"]').attr("checked","checked"):$('input[name="'+i+'"]').removeAttr("checked"):-1!=i.indexOf("-")&&$('input[name="'+i+'"]').val(obj[i]),"file"==obj.filetype&&$("#recursive-control").remove()})}else 0==$(".fileid[data-isdir=true]:checked").length&&$("#recursive-control").remove()}function initPermissionControl(){$(document).on("change",".perm-checkbox",function(){let e=$(".perm-checkbox[name=user_read]:checked").length?1:0,t=$(".perm-checkbox[name=user_write]:checked").length?1:0,i=$(".perm-checkbox[name=user_execute]:checked").length?1:0,a=$(".perm-checkbox[name=group_read]:checked").length?1:0,l=$(".perm-checkbox[name=group_write]:checked").length?1:0,o=$(".perm-checkbox[name=group_execute]:checked").length?1:0,n=$(".perm-checkbox[name=world_read]:checked").length?1:0,r=$(".perm-checkbox[name=world_write]:checked").length?1:0,s=$(".perm-checkbox[name=world_execute]:checked").length?1:0,d=4*e+2*t+i,c=4*a+2*l+o,p=4*n+2*r+s,m="0"+d+c+p;$("#file-permission").val(m)})}function editImage(e){let t=$(window).width(),i=$(window).height(),a='<div id="image-editor-layer"></div>';$("#all").append(a),$("#image-editor-layer").css({width:"0px",height:"0px"});let l=getQueryParams();l.filepath=e,$.get("tool-image-editor-form.php",l,function(e){$("#image-editor-layer").html(e);let a=i-73;$(".image-editor-sidebar-inner, .image-editor-mainbar-inner").css("height",a+"px");let l={to:{width:t,height:i}};$("#image-editor-layer").show("size",l,500,callbackShowImageEditor),initImageEditorForm()})}function initImageEditorForm(){$(".new-dimension input[type=checkbox]").each(function(e){$(this).css({border:"none",padding:"0"})}),setSizeImageEditor(),filepath=$("#curfilepath").val(),fileurl=$("#curfileurl").val();let e=parseInt($("#curwidth").val()),t=parseInt($("#curheight").val());imgwidth=e,imgheight=t,angle=0,fliph=0,flipv=0,$(document).on("change","#newwidth",function(){if($("#aspectratio:checked").val()){let i=1;i=angle%180==0?t/e:e/t;let a=parseInt($(this).val()),l=parseInt(i*a);$("#newheight").val(l)}$("#image2edit").css({width:$("#newwidth").val()+"px",height:$("#newheight").val()+"px"}),imgwidth=$("#newwidth").val(),imgheight=$("#newheight").val(),previewImageEdit()}),$(document).on("change","#newheight",function(){if($("#aspectratio:checked").val()){let i=1;i=angle%180==0?e/t:t/e;let a=parseInt($(this).val()),l=parseInt(i*a);$("#newwidth").val(l)}$("#image2edit").css({width:$("#newwidth").val()+"px",height:$("#newheight").val()+"px"}),imgwidth=$("#newwidth").val(),imgheight=$("#newheight").val(),previewImageEdit()}),$(document).on("click","#cropimage",function(){crop=$(this).attr("checked")?1:0,previewImageEdit()}),$(window).resize(function(){setSizeImageEditor()})}function setSizeImageEditor(){let e=parseInt($(window).height()),t=parseInt($(window).width()),i=e-73,a=t-200;$(".image-editor-sidebar-inner, .image-editor-mainbar-inner").css("height",i+"px"),$("#image-editor-layer").css("height",e+"px"),$("#curfilepath").css("width",a+"px")}function callbackShowImageEditor(){$("#wrapper").css("display","none"),$("#image-editor-layer").css("position","static"),$("#image-editor-layer").css("width","100%")}function callbackDestroyImageEditor(){$("#image-editor-layer").remove()}function destroyImageEditor(){$("#wrapper").css("display","block"),$("#image-editor-layer").css("top",0),$("#image-editor-layer").css("left",0),$("#image-editor-layer").css("position","absolute");let e={to:{width:0,height:0}};$("#image-editor-layer").hide("size",e,500,function(){$("#image-editor-layer").remove()})}function previewImageEdit(){let e=1e3*Math.random(),t='<img src="tool-image-editor-thumbnail.php?filepath='+encodeURIComponent(filepath)+"&flipv="+flipv+"&fliph="+fliph+"&angle="+angle+"&width="+imgwidth+"&height="+imgheight+"&crop="+crop+"&rand="+e+'" >';$("#image-content").html(t)}function saveImage(){if(confirm("Are you sure to save this state and replace current file?")){filepath=$("#curfilepath").val();let e="option=save2file&filepath="+encodeURIComponent(filepath)+"&flipv="+flipv+"&fliph="+fliph+"&angle="+angle+"&width="+imgwidth+"&height="+imgheight+"&crop="+crop,t="?";t=updateQueryParam(t),$.post("tool-image-editor-thumbnail.php"+t,{postdata:e},function(e){if("SUCCESS"==e){let e=getQueryParams();e.filepath=filepath,$.get("tool-image-editor-form.php",e,function(e){$("#image-editor-layer").html(e),
initImageEditorForm()})}else"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only")})}}function rotateCW(){for(angle-=90;angle<0;)angle+=360;angle%=360,imgwidth=$("#newwidth").val(),imgheight=$("#newheight").val();let e=imgwidth;imgwidth=imgheight,imgheight=e,$("#newwidth").val(imgwidth),$("#newheight").val(imgheight),previewImageEdit()}function rotateCCW(){for(angle+=90;angle>360;)angle-=360;angle%=360,imgwidth=$("#newwidth").val(),imgheight=$("#newheight").val();let e=imgwidth;imgwidth=imgheight,imgheight=e,$("#newwidth").val(imgwidth),$("#newheight").val(imgheight),previewImageEdit()}function flipV(){flipv++,flipv%=2,previewImageEdit()}function flipH(){fliph++,fliph%=2,previewImageEdit()}function resizeImage(){resize++,resize%=2,resize?$(".image-tool-resize-dimension").slideDown(400):$(".image-tool-resize-dimension").slideUp(400)}function about(){let e='<table width="100%" border="0" cellpadding="0" cellspacing="0" class="dialog-table dialog-about"><tr><td width="40%">Module Name</td><td>Planetbiru File Manager</td></tr><tr><td>Version</td><td>2.2</td></tr><tr><td>Developer</td><td><a href="http://www.planetbiru.com" target="_blank">Kamshory Developer</a></td></tr><tr><td>Release Date</td><td>2012-10-20</td></tr><tr><td>Price</td><td>30 USD</td></tr><tr><td>Sponsored Link</td><td><a href="http://www.planetbiru.com/" target="_blank">Planetbiru</a></td></tr><tr><td>Information</td><td><a href="javascript:;" onclick="return showInformation();">Click Here</a></td></tr></table>';overlayDialog(e,320,140),$(".dialog-about a").css({"text-decoration":"none"}),fixOverlayDialogToInner(".dialog-about")}function preventSelect(e){skipondrop=!0}function initDropable(){$(".file-list .row-data-dir").draggable({drag:function(){preventSelect($(this).attr("data-file-url")),$(this).css({"z-index":400,opacity:.8})}}),$(".file-list .row-data-file").draggable({drag:function(){preventSelect($(this).attr("data-file-url")),$(this).css({"z-index":400,opacity:.8})}}),$(".file-list .row-data-dir").droppable({activeClass:"directory-drop-active",hoverClass:"directory-drop-hover",drop:function(e,t){let i=t.draggable.attr("data-file-location")+"/"+t.draggable.attr("data-file-name"),a=$(this).attr("data-file-location")+"/"+$(this).attr("data-file-name"),l="targetdir="+encodeURIComponent(a);l+="&file[]="+encodeURIComponent(i);let o="?option=copyfile&deletesource=1";return o=updateQueryParam(o),$.post("tool-file-operation.php"+o,{postdata:l},function(e){"SUCCESS"==e||"EXIST"==e?openDir():"READONLY"==e&&jqAlert("The operation was disabled on read-only mode.","Read-Only")}),skipondrop=!0,t.draggable.hide("scale",{percent:0},300,function(){t.draggable.css("display","none"),openDir()}),!1}})}function loadAnimationStart(){$("#anim-loader").addClass("anim-active")}function loadAnimationStop(){$("#anim-loader").removeClass("anim-active")}function openDirSearch(e){openDir(e),$("#common-dialog").dialog("destroy")}function selectFileSeach(e){selectFile(e),$("#common-dialog").dialog("destroy")}function openDirTree(){let e,t,i=$("#address").val(),a=i.split("/"),l="base",o="",n=[];for(e in a)if(n.push(a[e]),o=n.join("/"),t=$('a[onclick~="'+o+'"]').parent(),"base"!=o){if(!$("#directory-container").find('a[onclick~="'+o+'"]').length){let t='<ul><li class="row-data-dir dir-control" data-file-path="'+o+'" data-file-name="'+a[e]+'" data-file-location="'+l+'"><a href="javascript:;" onclick="return openDir(\''+o+"')\">"+a[e]+"</a></li></ul>";$("#directory-container").find('[data-file-path="'+l+'"]').append(t)}l=o}return openDir(),!1}function mergeObject(e,t){void 0===e&&(e={});for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function getQueryParams(){return parseQueryParams(window.location.search)}function updateQueryParam(e){let t=getQueryParams(),i=parseQueryParams(e);mergeObject(i,t);let a="?"+serializeQueryParams(i);return a}function parseQueryParams(e){let t=new URLSearchParams(e),i={};return t.forEach((e,t)=>{i[t]=e}),i}function serializeQueryParams(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t.join("&")}function openDir(filepath,selfile,sortby,sortorder){if(!skipondrop){loadAnimationStart();let ret=!0;if(filepath)try{filepath=filepath.trim("/")}catch(e){}else filepath=$("#address").val(),ret=!1;$("#address").val(filepath);let arg={};arg=togglethumb?{curdir:filepath,thumbnail:1}:{curdir:filepath},sortby&&(arg.sortby=sortby),sortorder&&(arg.sortorder=sortorder);let data=getQueryParams();arg=mergeObject(arg,data),$.get("tool-load-file-json.php",arg,function(answer){if(arrthumbnail=eval(answer),arrthumbnailURL=new Array,arrthumbnail.length){let e=0;for(e in arrthumbnail)arrthumbnailURL[e]=arrthumbnail[e].url}}),$.get("tool-load-file.php",arg,function(e){$("#file-container").html(e);try{if(selfile.length){let e="";$(".fileid").each(function(t){e=$(this).val(),-1!=$.inArray(e,selfile)&&$(this).attr("checked","checked")})}if($(".fileid:checked").length==$(".fileid").length&&$(".fileid").length)try{$("#control-fileid").attr("checked","checked")}catch(e){}else try{$("#control-fileid").removeAttr("checked")}catch(e){}}catch(e){}initContextMenuFile(),initContextMenuDir(),setCheckRelation(),initDropable(),loadAnimationStop(),removeCheckboxBorder(),updateToolbarStatus(),$("#directory-container .basedir ul li").removeClass("dir-open").addClass("dir-normal"),$('#directory-container .basedir ul li[data-file-path="'+filepath+'"]').addClass("dir-open")});let pth="",data2=getQueryParams();return data2.seldir=filepath,$.get("tool-load-dir.php",data2,function(e){$(".dir-control").each(function(t){pth=$(this).attr("data-file-location")+"/"+$(this).attr("data-file-name"),"/"==pth[pth.length]&&(pth=pth.substring(0,pth.length-1)),"/"==pth[0]&&(pth=pth.substring(1)),filepath==pth&&($(this).children("ul").remove(),$(this).append(e))})}),ret}skipondrop=!1,$(".row-data-dir").css({left:"0px",top:"0px","z-index":0,opacity:1}),$(".row-data-file").css({left:"0px",top:"0px","z-index":0,opacity:1})}function selectFile(e){skipondrop||selectFileIndex(e),skipondrop=!1,$(".row-data-dir").css({left:"0px",top:"0px","z-index":0,opacity:1}),$(".row-data-file").css({left:"0px",top:"0px","z-index":0,opacity:1})}function removeCheckboxBorder(){$("#file-container input[type=checkbox]").each(function(e){$(this).css({border:"none",padding:"0"})})}function initSortable(){$(document).on("click",".sort-holder",function(){let e=$("#address").val(),t=$(this).attr("data-sortby"),i=$(this).attr("data-sortorder"),a=new Array;$(".fileid:checked").each(function(e){a[a.length]=$(this).val()}),openDir(e,a,t,i)})}function showPermission(e){e+="",e.length>3&&(e=e.substr(e.length-3));let t=parseInt(e.substr(0,1)),i=parseInt(e.substr(1,1)),a=parseInt(e.substr(2,1)),l=(t>>2)%2,o=(t>>1)%2,n=t%2,r=(i>>2)%2,s=(i>>1)%2,d=i%2,c=(a>>2)%2,p=(a>>1)%2,m=a%2,u={user_execute:n,user_write:o,user_read:l,group_execute:d,group_write:s,group_read:r,world_execute:m,world_write:p,world_read:c};return u}function initPermission(){$(document).on("click",".permission-info",function(){let e=$(this).text()+"";try{$("#perms-dialog").dialog("destroy")}catch(e){}let t,i=showPermission(e);for(t in i)$("."+t).text(1==parseInt(i[t])?"Allowed":"Disallowed");$("#perms-dialog").dialog({resizable:!1,modal:!0,width:280,height:165}),$(".permission-table").fadeIn(200)})}function showInformation(){$("#common-dialog-inner").html(""),$("#common-dialog").dialog({modal:!0,title:"Information",width:400,height:310,buttons:{Close:function(){$(this).dialog("destroy")}}});let e=getQueryParams();return $.get("tool-info.php",e,function(e){$("#common-dialog-inner").html(e)}),!1}function searchFile(){let e=$("#address").val(),t='<div class="search-container"><div class="search-inner"><div class="search-form"><form name="searchform"><div class="search-direactory"><div class="search-label">Location</div><div class="search-input"><input type="text" name="sdir" id="sdir" class="input-search" readonly="readonly" /></div></div><div class="search-query"><div class="search-label">Filter</div><div class="search-input"><input type="text" name="sfile" id="sfile" class="input-search" /></div></div></form></div><div class="search-result"><div class="loading-animation">Loading directory content...</div></div></div></div>',i=$("body").width()-14,a=$("body").height()-14,l=a-136;$("#common-dialog").dialog({modal:!0,title:"Search File",width:i,height:a}),$("#common-dialog-inner").html(t),$(".search-result").css({height:l+"px",overflow:"auto"}),$(document).on("keyup","#sfile",function(){filterFile($(this).val())}),$(document).on("change","#sfile",function(){filterFile($(this).val())}),$("#sdir").val(e),$("#sfile").select();let o=getQueryParams();o.dir=e,$.get("tool-search-file.php",o,function(e){$(".search-result").html(e),normalizeTable()})}function normalizeTable(){$(".file-result-table tbody tr").each(function(e,t){$(this).attr("data-file-name-lower",$(this).attr("data-file-name").toLowerCase())})}function filterFile(e){e=e.toLowerCase(),$(".file-result-table").css({display:""}),""==e?$(".file-result-table tbody tr").css({display:""}):($(".file-result-table tbody tr").css({display:"none"}),$('.file-result-table tbody tr[data-file-name-lower*="'+e+'"]').css({display:""})),0==$(".file-result-table tbody tr:visible").length&&$(".file-result-table").css({display:"none"})}function initEXIF(){$(document).on("click",".capture-info",function(){try{$("#exif-dialog").dialog("destroy")}catch(e){}$("#exif-dialog").remove(),$("#dialogs").append('<div id="exif-dialog"><div id="exif-dialog-inner"></div></div>');let jsdata=eval(decodeURIComponent($(this).attr("data-exif"))),key,obj=jsdata[0],html='<table width="100%" border="0" cellspacing="1" cellpadding="2" class="table table-striped table-sm exif-table">';for(key in html+="<tbody>",obj)html+='<tr><td width="50%">'+key+"</td><td>"+obj[key]+"</td></tr>";html+="</tbody></table>",$("#exif-dialog-inner").html(html),$("#exif-dialog").dialog({resizable:!1,modal:!0,title:"Capture Information",width:400,height:410,buttons:{Close:function(){$("#exif-dialog").dialog("destroy")}}})})}function relative2absolute(e){return vabs+e.substr(vrel.length)}function absolute2relative(e){return vrel+e.substr(vabs.length)}function toggleFocusInput(){$(document).on("focus",":input",function(){focusOnInput=!0}),$(document).on("blur",":input",function(){focusOnInput=!1})}function initHotKey(){toggleFocusInput(),$(document).on("keypress",function(e){e.ctrlKey&&!focusOnInput&&(65!=e.which&&97!=e.which||(ca=!ca,selectAll(ca),e.preventDefault()),67!=e.which&&99!=e.which||(copySelectedFile(),e.preventDefault()),86!=e.which&&118!=e.which||(pasteFile(),e.preventDefault()),88!=e.which&&120!=e.which||(cutSelectedFile(),e.preventDefault()),70!=e.which&&102!=e.which||(searchFile(),e.preventDefault()),68!=e.which&&100!=e.which||(thumbnail(),e.preventDefault()))})}function FileDragHover(e){e.stopPropagation(),e.preventDefault(),"dragover"==e.type?$(".file-area").addClass("file-area-hover"):$(".file-area").removeClass("file-area-hover")}function FileSelectHandler(e){FileDragHover(e);let t=e.target.files||e.dataTransfer.files,i=new FormData,a='<div class="file-upload-caption">Uploading...</div>';a+='<div class="progressbar" style="margin:5px 0px;height:10px; background-color:#EEEEEE;"><div class="progressbar-inner" style="height:10px;background-color:rgb(23, 96, 125);width:0%;"></div></div>',a+='<div class="file-upload" style="height:180px; overflow:auto;">';for(let e in t)i.append("images[]",t[e]),a+='<div class="file-upload-item" style="white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">'+t[e].name+"</div>";a+="</div>",overlayDialog(a,360,224),xhr.open("POST","tool-upload-file-multi.php?targetdir="+encodeURIComponent($("#address").val())),xhr.onload=function(){200===xhr.status&&(refreshList(),closeOverlayDialog())},xhr.upload.addEventListener("progress",progressHandler,!1),xhr.addEventListener("load",completeHandler,!1),xhr.addEventListener("error",errorHandler,!1),xhr.addEventListener("abort",abortHandler,!1),xhr.send(i)}function progressHandler(e){let t=e.loaded/e.total*100;$(".progressbar-inner").css({width:t+"%"})}function completeHandler(e){let t=e.target.responseText,i=$.parseJSON(t);$(".progressbar-inner").css({width:"0%"}),i.success&&closeOverlayDialog()}function errorHandler(e){jqAlert("Uploading error.","Error")}function abortHandler(e){jqAlert("Process aborted.","Aborted")}function initDragDropUpload(){if(window.File&&window.FileList&&window.FileReader){let e=$(".file-area")[0];xhr.upload&&(e.addEventListener("dragover",FileDragHover,!1),e.addEventListener("dragleave",FileDragHover,!1),e.addEventListener("drop",FileSelectHandler,!1),e.style.display="block")}}function getVideoDimensionsOf(e){return new Promise(function(t){let i=document.createElement("video");i.addEventListener("loadedmetadata",function(){let e=this.videoHeight,i=this.videoWidth;t({height:e,width:i})},!1),i.src=e})}function cookieRead(e){let t="",i=e+"=";if(document.cookie.length>0){let e=document.cookie.indexOf(i);if(-1!=e){e+=i.length;let a=document.cookie.indexOf(";",e);-1==a&&(a=document.cookie.length),t=unescape(document.cookie.substring(e,a))}}return t}function cookieWrite(e,t,i){let a="";null!=i&&(a=new Date((new Date).getTime()+36e5*i),a=";expires="+a.toGMTString()),document.cookie=e+"="+escape(t)+a}let angle=0,fliph=0,flipv=0,resize=0,imgwidth=1,imgheight=1,crop=0,filepath="",fileurl="",arrthumbnail=new Array,arrthumbnailURL=new Array,startX,startY,endX,endY,centerX,centerY,width,height,show=!1,xhr;if(window.XMLHttpRequest)xhr=new XMLHttpRequest;else{let e=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];for(let t=0,i=e.length;t<i;t++)try{xhr=new ActiveXObject(e[t]);break}catch(e){}}let skipondrop=!1,thumbnailIndexCur=0,thumbnailIndexNext=0,thumbnailIndexPrev=0;String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};let cnt1="",cnt2="",togglethumb=!1,clipboardfile={operation:"",content:[]},ca=!1,focusOnInput=!1;